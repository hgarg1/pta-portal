<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Riverbend PTA Portal – Family · Principal · Board · Students</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      color-scheme: light;
      --bg-app: #0f172a;
      --bg-surface: rgba(15, 23, 42, 0.65);
      --bg-panel: rgba(15, 23, 42, 0.35);
      --bg-card: rgba(15, 23, 42, 0.55);
      --bg-card-light: rgba(15, 23, 42, 0.25);
      --text-primary: #f8fafc;
      --text-muted: #cbd5f5;
      --accent-mint: #34d399;
      --accent-cornflower: #60a5fa;
      --accent-gold: #facc15;
      --accent-rose: #fb7185;
      --shadow-lg: 0 24px 60px rgba(8, 15, 40, 0.45);
      --shadow-sm: 0 10px 30px rgba(8, 15, 40, 0.28);
      --radius-lg: 32px;
      --radius-md: 20px;
      --radius-sm: 12px;
      --gradient-aurora: linear-gradient(135deg, rgba(96, 165, 250, 0.22), rgba(52, 211, 153, 0.18));
      --gradient-sunrise: linear-gradient(135deg, rgba(250, 204, 21, 0.32), rgba(251, 113, 133, 0.25));
      font-size: 16px;
    }

    *, *::before, *::after {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      line-height: 1.6;
      background: radial-gradient(circle at 20% 20%, rgba(96, 165, 250, 0.25), transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(251, 191, 36, 0.2), transparent 50%),
        #020617;
      color: var(--text-primary);
      min-height: 100vh;
      -webkit-font-smoothing: antialiased;
      transition: background 0.4s ease, color 0.4s ease;
    }

    body.theme-family,
    body.theme-board {
      background: radial-gradient(circle at 20% 20%, rgba(96, 165, 250, 0.25), transparent 55%),
        radial-gradient(circle at 80% 0%, rgba(251, 191, 36, 0.2), transparent 50%),
        #020617;
      color: var(--text-primary);
    }

    body.theme-principal {
      background: #020617;
      color: var(--text-primary);
    }

    body.theme-student {
      background: radial-gradient(circle at top, #e0f2fe 0, #f9fafb 38%, #fef3c7 100%);
      color: #111827;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    a.portal-inline-link {
      color: var(--accent-cornflower);
      text-decoration: underline;
    }

    button {
      font: inherit;
      cursor: pointer;
      border: none;
      background: none;
      color: inherit;
    }

    [hidden] {
      display: none !important;
    }

    button:focus-visible,
    a:focus-visible {
      outline: 3px solid rgba(96, 165, 250, 0.5);
      outline-offset: 4px;
    }

    .portal-app {
      min-height: 100vh;
      padding: 2.5rem;
    }

    @media (max-width: 1280px) {
      .portal-app {
        padding: 1.5rem;
      }
    }

    @media (max-width: 960px) {
      .portal-app {
        padding: 1rem;
      }
    }

    .portal-layout {
      display: grid;
      grid-template-columns: 320px minmax(0, 1fr);
      background: rgba(15, 23, 42, 0.55);
      backdrop-filter: blur(26px);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      overflow: hidden;
      min-height: calc(100vh - 3rem);
      position: relative;
      isolation: isolate;
    }

    @media (max-width: 1040px) {
      .portal-layout {
        grid-template-columns: minmax(0, 1fr);
        min-height: auto;
      }
    }

    .portal-rail {
      padding: 2.25rem 2rem;
      background: rgba(9, 16, 34, 0.82);
      border-right: 1px solid rgba(148, 163, 184, 0.08);
      display: flex;
      flex-direction: column;
      gap: 2.5rem;
      position: relative;
    }

    .portal-rail::after {
      content: "";
      position: absolute;
      inset: 2rem;
      border-radius: var(--radius-md);
      background: var(--gradient-aurora);
      opacity: 0.7;
      filter: blur(48px);
      z-index: -1;
    }

    @media (max-width: 1040px) {
      .portal-rail {
        border-right: none;
        border-bottom: 1px solid rgba(148, 163, 184, 0.08);
        padding: 1.75rem 1.5rem 1.5rem;
      }
      .portal-rail::after {
        inset: 1.5rem;
        filter: blur(36px);
      }
    }

    .portal-identity {
      display: grid;
      gap: 0.6rem;
    }

    .portal-mark {
      width: 54px;
      height: 54px;
      border-radius: 18px;
      background: var(--gradient-sunrise);
      display: grid;
      place-items: center;
      font-weight: 700;
      font-size: 1.2rem;
      color: #111827;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.35);
    }

    .portal-brand-text-main {
      font-size: 1.1rem;
      font-weight: 600;
      letter-spacing: 0.04em;
    }

    .portal-brand-text-sub {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .portal-overview-text {
      font-size: 0.92rem;
      color: rgba(226, 232, 240, 0.9);
      margin-top: 0.5rem;
      line-height: 1.7;
    }

    .portal-view-switcher {
      display: grid;
      gap: 0.75rem;
    }

    .portal-toggle-label {
      text-transform: uppercase;
      letter-spacing: 0.12em;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .view-toggle-btn {
      display: flex;
      align-items: center;
      gap: 0.85rem;
      padding: 0.85rem 1rem;
      border-radius: var(--radius-sm);
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.1);
      transition: transform 0.2s ease, background 0.2s ease, border 0.2s ease;
      font-weight: 500;
      letter-spacing: 0.01em;
    }

    .view-toggle-btn span {
      font-size: 1.3rem;
    }

    .view-toggle-btn.active {
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.35), rgba(52, 211, 153, 0.25));
      border-color: rgba(148, 163, 184, 0.45);
      box-shadow: var(--shadow-sm);
      transform: translateX(4px);
    }

    .view-toggle-btn:hover:not(.active) {
      border-color: rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.75);
    }

    .portal-rail-footer {
      margin-top: auto;
      font-size: 0.8rem;
      color: rgba(226, 232, 240, 0.6);
      line-height: 1.5;
    }

    .portal-main {
      background: radial-gradient(circle at top right, rgba(96, 165, 250, 0.35), transparent 50%),
        rgba(15, 23, 42, 0.55);
      position: relative;
      padding: 3rem clamp(1.75rem, 2.4vw, 3.25rem);
      display: flex;
      flex-direction: column;
      gap: 3rem;
    }

    .portal-main::before {
      content: "";
      position: absolute;
      inset: 0;
      background: var(--gradient-aurora);
      opacity: 0.35;
      filter: blur(120px);
      z-index: -1;
    }

    @media (max-width: 1040px) {
      .portal-main {
        padding: 2.5rem clamp(1.25rem, 4vw, 2.5rem);
      }
    }

    .view-stage {
      display: grid;
      gap: 3rem;
    }

    .view {
      display: none;
    }

    .view.active {
      display: grid;
      gap: 3rem;
    }

    .family-root,
    .principal-root,
    .pta-board-root,
    .student-root {
      display: grid;
      gap: 2.75rem;
    }

    .family-hero,
    .principal-hero,
    .student-hero,
    .pta-board-hero {
      display: grid;
      gap: 2.5rem;
    }

    @media (min-width: 1024px) {
      .family-hero {
        grid-template-columns: minmax(0, 1fr) 320px;
        align-items: stretch;
      }
    }

    .family-hero-tag {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.2em;
      color: var(--accent-mint);
    }

    .family-hero-tag-dot,
    .family-today-pill-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--accent-mint);
      box-shadow: 0 0 16px rgba(52, 211, 153, 0.85);
    }

    .family-hero-title {
      font-size: clamp(2.7rem, 4vw, 3.2rem);
      line-height: 1.1;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .family-hero-title span {
      color: var(--accent-cornflower);
    }

    .family-hero-sub {
      color: var(--text-muted);
      max-width: 52ch;
    }

    .family-hero-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      color: rgba(226, 232, 240, 0.75);
      font-size: 0.9rem;
    }

    .family-hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-top: 0.75rem;
    }

    .family-btn-primary {
      background: linear-gradient(135deg, #60a5fa, #34d399);
      color: #0f172a;
      border-radius: 999px;
      padding: 0.85rem 1.7rem;
      font-weight: 600;
      box-shadow: var(--shadow-sm);
    }

    .family-btn-ghost {
      padding: 0.85rem 1.7rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: var(--text-muted);
      background: rgba(15, 23, 42, 0.45);
    }

    .family-today-card {
      background: var(--bg-card);
      border-radius: var(--radius-md);
      padding: 1.75rem;
      display: grid;
      gap: 1.25rem;
      border: 1px solid rgba(148, 163, 184, 0.15);
      box-shadow: var(--shadow-sm);
    }

    .family-today-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .family-today-title {
      font-weight: 600;
      font-size: 1.05rem;
    }

    .family-today-date {
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .family-today-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      background: rgba(52, 211, 153, 0.2);
      color: var(--accent-mint);
      padding: 0.45rem 0.85rem;
      border-radius: 999px;
      font-size: 0.8rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .family-today-list {
      list-style: none;
      display: grid;
      gap: 0.9rem;
    }

    .family-today-item-title {
      font-weight: 500;
    }

    .family-today-item-meta {
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .family-today-note {
      font-size: 0.9rem;
      color: rgba(226, 232, 240, 0.85);
    }

    .family-nav {
      background: var(--bg-panel);
      border-radius: var(--radius-md);
      padding: 1.2rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      box-shadow: var(--shadow-sm);
      flex-wrap: wrap;
    }

    .family-school-mark {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      background: rgba(96, 165, 250, 0.35);
      display: grid;
      place-items: center;
      font-weight: 600;
      letter-spacing: 0.05em;
    }

    .family-nav-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.85rem;
      font-size: 0.92rem;
      color: var(--text-muted);
    }

    .family-nav-links a {
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      transition: background 0.2s ease, color 0.2s ease;
      border: 1px solid transparent;
    }

    .family-nav-links a:hover,
    .family-nav-links a:focus-visible,
    .family-nav-pill {
      border-color: rgba(96, 165, 250, 0.35);
      background: rgba(96, 165, 250, 0.2);
      color: #fff;
    }

    .family-section {
      display: grid;
      gap: 1.75rem;
      background: var(--bg-panel);
      padding: 1.75rem;
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.12);
      box-shadow: var(--shadow-sm);
    }

    .family-section-header {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    @media (min-width: 960px) {
      .family-section-header {
        flex-direction: row;
        justify-content: space-between;
        align-items: flex-end;
        gap: 2rem;
      }
      .family-section-sub {
        max-width: 40ch;
      }
    }

    .family-section-kicker {
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--accent-cornflower);
      font-size: 0.75rem;
    }

    .family-section-title {
      font-size: 1.8rem;
      font-weight: 600;
    }

    .family-section-sub {
      color: var(--text-muted);
      font-size: 0.95rem;
      line-height: 1.6;
    }

    .family-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .family-filter-pill {
      padding: 0.55rem 1.15rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.2);
      background: rgba(15, 23, 42, 0.55);
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .family-filter-pill.active {
      background: rgba(52, 211, 153, 0.25);
      color: var(--accent-mint);
      border-color: rgba(52, 211, 153, 0.4);
      box-shadow: var(--shadow-sm);
    }

    .family-events-grid {
      display: grid;
      gap: 1.5rem;
    }

    @media (min-width: 960px) {
      .family-events-grid {
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      }
    }

    .family-event-card {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.4rem;
      display: grid;
      gap: 0.85rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .family-event-card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-sm);
    }

    .family-event-badges {
      display: flex;
      gap: 0.4rem;
    }

    .family-event-badge {
      padding: 0.35rem 0.7rem;
      border-radius: 999px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      background: rgba(96, 165, 250, 0.24);
      color: var(--accent-cornflower);
    }

    .family-event-badge--today {
      background: rgba(250, 204, 21, 0.3);
      color: var(--accent-gold);
    }

    .family-event-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .family-event-meta {
      display: grid;
      gap: 0.4rem;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .family-event-note {
      font-size: 0.95rem;
      color: rgba(226, 232, 240, 0.9);
    }

    .family-event-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.45rem;
    }

    .family-event-tag-pill {
      padding: 0.3rem 0.75rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.65);
      border: 1px solid rgba(148, 163, 184, 0.18);
      font-size: 0.75rem;
    }

    .family-upcoming-grid {
      display: grid;
      gap: 1.2rem;
    }

    @media (min-width: 880px) {
      .family-upcoming-grid {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .family-upcoming-card {
      background: var(--bg-card-light);
      border-radius: var(--radius-sm);
      padding: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.7rem;
    }

    .family-upcoming-when {
      color: var(--accent-cornflower);
      font-weight: 500;
    }

    .family-volunteer-callouts {
      display: grid;
      gap: 1.25rem;
    }

    @media (min-width: 880px) {
      .family-volunteer-callouts {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .family-volunteer-card {
      background: var(--bg-card);
      padding: 1.4rem;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.75rem;
    }

    .family-resources-grid {
      display: grid;
      gap: 1rem;
    }

    @media (min-width: 960px) {
      .family-resources-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .family-resource-card {
      background: var(--bg-card-light);
      border-radius: var(--radius-sm);
      padding: 1.2rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.6rem;
    }

    .family-info-panel {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      display: grid;
      gap: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.16);
    }

    .family-info-form {
      display: grid;
      gap: 1rem;
    }

    .family-info-form label {
      display: grid;
      gap: 0.4rem;
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .family-info-form input,
    .family-info-form select {
      padding: 0.7rem 1rem;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 23, 42, 0.75);
      color: inherit;
    }

    .family-info-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .family-submit-btn {
      background: linear-gradient(135deg, #34d399, #22d3ee);
      color: #0f172a;
      border-radius: 999px;
      padding: 0.75rem 1.4rem;
      font-weight: 600;
      border: none;
    }

    .family-info-note {
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.75);
    }

    .family-stay-connected {
      background: var(--bg-card-light);
      border-radius: var(--radius-sm);
      padding: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.8rem;
    }

    .family-footer {
      text-align: center;
      color: rgba(226, 232, 240, 0.6);
      font-size: 0.85rem;
    }

    /* Principal view */
    .principal-hero {
      background: var(--bg-panel);
      border-radius: var(--radius-md);
      padding: 2rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      box-shadow: var(--shadow-sm);
      position: relative;
    }

    .principal-kicker {
      font-size: 0.75rem;
      letter-spacing: 0.24em;
      text-transform: uppercase;
      color: var(--accent-gold);
    }

    .principal-title {
      font-size: clamp(2.4rem, 3.6vw, 2.9rem);
      margin-top: 0.6rem;
      line-height: 1.15;
    }

    .principal-sub {
      color: var(--text-muted);
      max-width: 70ch;
      margin-top: 0.85rem;
    }

    .principal-hero-grid {
      margin-top: 2rem;
      display: grid;
      gap: 1.5rem;
    }

    @media (min-width: 960px) {
      .principal-hero-grid {
        grid-template-columns: 240px 1fr;
        align-items: start;
      }
    }

    .principal-overview-card {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.16);
      display: grid;
      gap: 0.7rem;
    }

    .principal-stat-grid {
      display: grid;
      gap: 1rem;
    }

    @media (min-width: 880px) {
      .principal-stat-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .principal-stat-card {
      background: var(--bg-card-light);
      padding: 1.3rem;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.65rem;
    }

    .principal-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      padding: 0.3rem 0.65rem;
      border-radius: 999px;
      background: rgba(96, 165, 250, 0.2);
      color: var(--accent-cornflower);
      font-size: 0.75rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
    }

    .principal-status-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      background: rgba(15, 23, 42, 0.55);
      border-radius: var(--radius-sm);
      padding: 0.75rem 1rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .principal-panels {
      display: grid;
      gap: 1.25rem;
    }

    @media (min-width: 1024px) {
      .principal-panels {
        grid-template-columns: 280px minmax(0, 1fr);
        align-items: start;
      }
    }

    .principal-panel-nav {
      display: grid;
      gap: 0.6rem;
      background: var(--bg-card);
      padding: 1.1rem;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.12);
    }

    .principal-panel-nav button {
      justify-content: space-between;
      background: rgba(15, 23, 42, 0.45);
      border-radius: 12px;
      padding: 0.75rem 0.9rem;
      text-align: left;
      color: var(--text-muted);
      border: 1px solid transparent;
    }

    .principal-panel-nav button.active {
      border-color: rgba(96, 165, 250, 0.45);
      background: rgba(96, 165, 250, 0.2);
      color: #fff;
    }

    .principal-panel-content {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 1rem;
    }

    .principal-list {
      display: grid;
      gap: 0.75rem;
    }

    .principal-row {
      padding: 0.85rem 1rem;
      border-radius: 14px;
      background: rgba(15, 23, 42, 0.5);
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.45rem;
    }

    .principal-row-title {
      font-weight: 600;
    }

    .principal-row-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .principal-row-notes {
      font-size: 0.9rem;
      color: rgba(226, 232, 240, 0.9);
    }

    .principal-export-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: space-between;
      align-items: center;
      background: rgba(15, 23, 42, 0.55);
      padding: 0.9rem 1.1rem;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.12);
    }

    .principal-export-bar button {
      background: linear-gradient(135deg, #60a5fa, #34d399);
      color: #0f172a;
      border-radius: 999px;
      padding: 0.55rem 1.25rem;
      font-weight: 600;
    }

    .principal-status {
      color: rgba(226, 232, 240, 0.8);
      font-size: 0.85rem;
    }

    /* Board view */
    .pta-board-hero {
      background: var(--bg-panel);
      border-radius: var(--radius-md);
      padding: 2rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 1.2rem;
    }

    .pta-board-title {
      font-size: clamp(2.3rem, 3.5vw, 2.8rem);
      line-height: 1.15;
    }

    .pta-board-sub {
      color: var(--text-muted);
    }

    .pta-board-grid {
      display: grid;
      gap: 1.4rem;
    }

    @media (min-width: 960px) {
      .pta-board-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .pta-board-card {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.75rem;
    }

    .pta-board-pill {
      color: var(--accent-rose);
      text-transform: uppercase;
      letter-spacing: 0.16em;
      font-size: 0.75rem;
    }

    /* Student view */
    .student-hero {
      background: var(--bg-panel);
      border-radius: var(--radius-md);
      padding: 2rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 1.2rem;
    }

    .student-title {
      font-size: clamp(2.2rem, 3.2vw, 2.7rem);
      line-height: 1.15;
    }

    .student-sub {
      color: var(--text-muted);
    }

    .student-grid {
      display: grid;
      gap: 1.2rem;
    }

    @media (min-width: 960px) {
      .student-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .student-card {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.4rem;
      border: 1px solid rgba(148, 163, 184, 0.12);
      display: grid;
      gap: 0.75rem;
    }

    .student-card ul {
      padding-left: 1.1rem;
      display: grid;
      gap: 0.4rem;
    }

    .student-card li {
      color: rgba(226, 232, 240, 0.8);
    }

    .student-week-list {
      display: grid;
      gap: 0.75rem;
    }

    .student-week-item {
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.12);
      border-radius: 14px;
      padding: 0.85rem 1rem;
      display: grid;
      gap: 0.35rem;
    }

    /* Drawer and modal */
    .family-action-drawer,
    .principal-access-backdrop {
      position: fixed;
      inset: 0;
      display: grid;
      place-items: center;
      background: rgba(2, 6, 23, 0.62);
      backdrop-filter: blur(14px);
      z-index: 90;
    }

    .family-action-card,
    .principal-access-modal {
      background: rgba(15, 23, 42, 0.85);
      border-radius: var(--radius-md);
      padding: 2rem;
      border: 1px solid rgba(148, 163, 184, 0.16);
      box-shadow: var(--shadow-lg);
      max-width: min(560px, 90vw);
      display: grid;
      gap: 1rem;
    }

    .principal-access-modal h2 {
      font-size: 1.4rem;
    }

    .principal-access-modal form {
      display: grid;
      gap: 0.9rem;
    }

    .principal-access-modal input,
    .principal-access-modal button,
    .principal-access-modal textarea {
      font: inherit;
    }

    .principal-access-modal input[type="password"],
    .principal-access-modal input[type="text"],
    .principal-access-modal input[type="email"],
    .principal-access-modal textarea {
      padding: 0.7rem 1rem;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 23, 42, 0.75);
      color: inherit;
    }

    .principal-access-modal button[type="submit"],
    .principal-access-modal .primary-action {
      background: linear-gradient(135deg, #60a5fa, #34d399);
      color: #0f172a;
      border-radius: 999px;
      padding: 0.7rem 1.3rem;
      font-weight: 600;
    }

    .principal-access-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: rgba(15, 23, 42, 0.65);
      border-radius: 999px;
      width: 40px;
      height: 40px;
      display: grid;
      place-items: center;
      border: 1px solid rgba(148, 163, 184, 0.18);
    }

    .hidden {
      display: none !important;
    }

    @media (max-width: 720px) {
      .family-nav {
        flex-direction: column;
        align-items: flex-start;
      }
      .principal-panels {
        grid-template-columns: minmax(0, 1fr);
      }
      .principal-hero-grid {
        grid-template-columns: minmax(0, 1fr);
      }
      .portal-app {
        padding: 0;
      }
      .portal-layout {
        border-radius: 0;
      }
      .portal-main {
        padding: 1.75rem 1.25rem 3rem;
      }
    }
    /* Interaction + utility adjustments */
    .card-hover {
      transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
    }

    .card-hover:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-sm);
      border-color: rgba(148, 163, 184, 0.25);
    }

    .filtered-out {
      display: none !important;
    }

    /* Family view refinements */
    .family-shell {
      display: grid;
      gap: 2.5rem;
    }

    .family-nav-left {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .family-school-main {
      font-weight: 600;
      letter-spacing: 0.04em;
    }

    .family-school-sub {
      font-size: 0.8rem;
      color: var(--text-muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }

    .family-info-card {
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.14);
      display: grid;
      gap: 1.1rem;
      box-shadow: var(--shadow-sm);
    }

    .family-info-row {
      display: grid;
      gap: 0.75rem;
    }

    .family-link-btn {
      background: rgba(96, 165, 250, 0.18);
      border: 1px solid rgba(96, 165, 250, 0.45);
      border-radius: 999px;
      padding: 0.65rem 1.3rem;
      color: var(--accent-cornflower);
      font-weight: 600;
      transition: background 0.2s ease, transform 0.2s ease;
    }

    .family-link-btn:hover {
      background: rgba(96, 165, 250, 0.3);
      transform: translateY(-2px);
    }

    .family-feedback {
      font-size: 0.85rem;
      color: var(--accent-mint);
    }

    .family-footer-inner {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem 2rem;
      color: rgba(226, 232, 240, 0.75);
    }

    .family-footer-links {
      display: flex;
      flex-wrap: wrap;
      gap: 0.85rem;
    }

    .family-footer-links a {
      color: inherit;
      text-decoration: underline;
    }

    /* Family action drawer */
    .family-action-panel {
      background: rgba(15, 23, 42, 0.88);
      border-radius: var(--radius-md);
      padding: 2rem;
      border: 1px solid rgba(148, 163, 184, 0.16);
      max-width: min(480px, 92vw);
      position: relative;
      display: grid;
      gap: 1.25rem;
      box-shadow: var(--shadow-lg);
    }

    .family-action-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1.25rem;
    }

    .family-action-kicker {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--accent-cornflower);
      font-weight: 600;
    }

    .family-action-title {
      font-size: 1.5rem;
      margin-top: 0.25rem;
    }

    .family-action-close {
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid rgba(148, 163, 184, 0.25);
      width: 38px;
      height: 38px;
      border-radius: 999px;
      font-size: 1.4rem;
      line-height: 1;
      color: var(--text-muted);
      display: grid;
      place-items: center;
    }

    .family-action-body {
      display: grid;
      gap: 1rem;
      font-size: 0.92rem;
      color: rgba(226, 232, 240, 0.88);
    }

    /* Principal view */
    .principal-root {
      display: grid;
      gap: 2rem;
    }

    .principal-page {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.16);
      box-shadow: var(--shadow-sm);
      display: grid;
      gap: 2rem;
      padding: 2rem;
    }

    @media (min-width: 1080px) {
      .principal-page {
        grid-template-columns: 280px minmax(0, 1fr);
        align-items: start;
      }
    }

    .principal-sidebar {
      display: grid;
      gap: 1.2rem;
      background: rgba(15, 23, 42, 0.7);
      border-radius: var(--radius-sm);
      padding: 1.5rem;
      border: 1px solid rgba(148, 163, 184, 0.18);
      position: sticky;
      top: 2rem;
      align-self: start;
    }

    .principal-logo {
      width: 52px;
      height: 52px;
      border-radius: 16px;
      background: linear-gradient(135deg, rgba(250, 204, 21, 0.55), rgba(251, 113, 133, 0.45));
      color: #0f172a;
      display: grid;
      place-items: center;
      font-weight: 700;
      font-size: 1rem;
      box-shadow: 0 20px 38px rgba(8, 15, 40, 0.5);
    }

    .principal-school-name {
      font-weight: 600;
      font-size: 1rem;
    }

    .principal-role {
      font-size: 0.82rem;
      color: var(--text-muted);
    }

    .principal-sidebar-title {
      font-size: 0.72rem;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(203, 213, 225, 0.7);
      margin-top: 1.5rem;
    }

    .principal-nav-list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 0.5rem;
    }

    .principal-nav-link {
      background: rgba(15, 23, 42, 0.55);
      border-radius: 14px;
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 0.6rem 0.85rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgba(226, 232, 240, 0.75);
      transition: transform 0.2s ease, border 0.2s ease, background 0.2s ease;
    }

    .principal-nav-link span:last-child {
      font-size: 0.75rem;
      color: rgba(226, 232, 240, 0.55);
    }

    .principal-nav-link:hover {
      border-color: rgba(96, 165, 250, 0.4);
      transform: translateX(3px);
    }

    .principal-nav-link.active {
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.4), rgba(52, 211, 153, 0.35));
      color: #0f172a;
      border-color: rgba(148, 163, 184, 0.45);
      box-shadow: var(--shadow-sm);
    }

    .principal-nav-link.active span:last-child {
      color: rgba(15, 23, 42, 0.7);
    }

    .principal-sidebar-note {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      padding: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.2);
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.8);
    }

    .principal-main {
      display: grid;
      gap: 1.8rem;
    }

    .principal-locked-banner {
      background: rgba(251, 113, 133, 0.18);
      border: 1px solid rgba(251, 113, 133, 0.45);
      border-radius: var(--radius-sm);
      padding: 0.85rem 1rem;
      color: #fecdd3;
      font-size: 0.85rem;
      display: none;
    }

    .principal-root[data-locked="true"] .principal-locked-banner {
      display: block;
    }

    .principal-root[data-locked="true"] .principal-main > *:not(.principal-locked-banner) {
      filter: blur(6px);
      pointer-events: none;
      user-select: none;
    }

    .principal-header {
      background: rgba(15, 23, 42, 0.7);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.75rem;
      display: grid;
      gap: 1.5rem;
    }

    .principal-title-block {
      display: grid;
      gap: 0.7rem;
    }

    .principal-controls {
      display: flex;
      flex-wrap: wrap;
      gap: 0.7rem;
      justify-content: flex-end;
      align-items: center;
    }

    .principal-btn-ghost,
    .principal-btn-outline,
    .principal-btn-solid {
      border-radius: 999px;
      padding: 0.55rem 1.2rem;
      font-weight: 600;
    }

    .principal-btn-ghost {
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: rgba(226, 232, 240, 0.75);
    }

    .principal-btn-outline {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.55);
      color: rgba(226, 232, 240, 0.85);
    }

    .principal-btn-solid {
      background: linear-gradient(135deg, #60a5fa, #34d399);
      border: none;
      color: #0f172a;
      box-shadow: var(--shadow-sm);
    }

    .principal-date-pill {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      padding: 0.3rem 0.8rem;
      color: rgba(226, 232, 240, 0.7);
      font-size: 0.8rem;
    }

    .principal-status-message {
      color: rgba(226, 232, 240, 0.8);
      font-size: 0.85rem;
    }

    .principal-filter-overlay {
      position: fixed;
      inset: 0;
      background: rgba(2, 6, 23, 0.7);
      backdrop-filter: blur(14px);
      z-index: 90;
      display: grid;
      place-items: center;
      padding: 1.5rem;
    }

    .principal-filter-panel {
      background: rgba(15, 23, 42, 0.85);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.5rem;
      max-width: min(520px, 100%);
      display: grid;
      gap: 1.1rem;
    }

    .principal-filter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }

    .principal-filter-group {
      border: 1px solid rgba(148, 163, 184, 0.25);
      border-radius: 16px;
      padding: 1rem;
      display: grid;
      gap: 0.75rem;
    }

    .principal-filter-group legend {
      padding: 0 0.5rem;
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.8);
    }

    .principal-filter-options {
      display: grid;
      gap: 0.6rem;
    }

    .principal-filter-option {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-size: 0.9rem;
    }

    .principal-filter-actions {
      display: flex;
      justify-content: flex-end;
      gap: 0.6rem;
    }

    .principal-panel {
      display: none;
      gap: 1.6rem;
    }

    .principal-panel.active {
      display: grid;
    }

    .principal-summary-grid {
      display: grid;
      gap: 1.2rem;
    }

    @media (min-width: 880px) {
      .principal-summary-grid {
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
    }

    .principal-summary-card {
      background: rgba(15, 23, 42, 0.65);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.4rem;
      display: grid;
      gap: 0.65rem;
    }

    .principal-summary-label {
      font-size: 0.9rem;
      color: rgba(226, 232, 240, 0.75);
    }

    .principal-summary-value {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .principal-summary-chip {
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.7);
    }

    .principal-summary-bar {
      height: 8px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.3);
      overflow: hidden;
    }

    .principal-summary-bar-fill {
      height: 100%;
      width: var(--fill, 50%);
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.8), rgba(52, 211, 153, 0.8));
      border-radius: inherit;
    }

    .principal-full-card,
    .principal-card,
    .principal-grid-2 > *,
    .principal-grid-3 > * {
      background: rgba(15, 23, 42, 0.65);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.5rem;
      display: grid;
      gap: 1rem;
    }

    .principal-card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1rem;
    }

    .principal-card-title {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .principal-card-sub {
      font-size: 0.9rem;
      color: rgba(226, 232, 240, 0.7);
    }

    .principal-small {
      font-size: 0.82rem;
      color: rgba(226, 232, 240, 0.65);
    }

    .principal-micro-note {
      font-size: 0.8rem;
      color: rgba(226, 232, 240, 0.6);
    }

    .principal-inline-note {
      padding: 0.6rem 0.75rem;
      border-left: 3px solid rgba(96, 165, 250, 0.6);
      background: rgba(15, 23, 42, 0.5);
      border-radius: 12px;
    }

    .principal-event-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
      background: rgba(15, 23, 42, 0.55);
      border-radius: 14px;
      overflow: hidden;
    }

    .principal-event-table th,
    .principal-event-table td {
      padding: 0.7rem 0.85rem;
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
    }

    .principal-event-table tbody tr:last-child td {
      border-bottom: none;
    }

    .principal-event-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.25rem 0.65rem;
      border-radius: 999px;
      background: rgba(96, 165, 250, 0.18);
      color: var(--accent-cornflower);
      font-size: 0.75rem;
    }

    .principal-grid-2,
    .principal-grid-3 {
      display: grid;
      gap: 1.4rem;
    }

    @media (min-width: 920px) {
      .principal-grid-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 1040px) {
      .principal-grid-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .principal-week-load {
      display: grid;
      gap: 0.9rem;
    }

    .principal-day-col {
      display: grid;
      gap: 0.45rem;
    }

    .principal-day-label {
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.75);
    }

    .principal-day-bar-wrapper {
      height: 8px;
      border-radius: 999px;
      background: rgba(148, 163, 184, 0.25);
      overflow: hidden;
    }

    .principal-day-bar {
      height: 100%;
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.6), rgba(52, 211, 153, 0.6));
      width: var(--pct, 50%);
      border-radius: inherit;
    }

    .principal-coverage-list,
    .principal-risk-list,
    .principal-checklist {
      list-style: none;
      display: grid;
      gap: 0.8rem;
      padding: 0;
      margin: 0;
    }

    .principal-coverage-item,
    .principal-risk-item,
    .principal-checklist li {
      display: grid;
      gap: 0.4rem;
      color: rgba(226, 232, 240, 0.85);
    }

    .principal-coverage-meter {
      height: 6px;
      background: rgba(148, 163, 184, 0.25);
      border-radius: 999px;
      overflow: hidden;
    }

    .principal-coverage-fill {
      height: 100%;
      width: var(--fill, 50%);
      background: linear-gradient(135deg, rgba(52, 211, 153, 0.8), rgba(96, 165, 250, 0.8));
      border-radius: inherit;
    }

    .principal-risk-tag-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.85rem;
    }

    .principal-risk-level {
      padding: 0.25rem 0.55rem;
      border-radius: 999px;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      border: 1px solid rgba(148, 163, 184, 0.35);
    }

    .principal-risk-low {
      color: #bbf7d0;
      border-color: rgba(52, 211, 153, 0.45);
    }

    .principal-risk-med {
      color: #fde68a;
      border-color: rgba(250, 204, 21, 0.45);
    }

    .principal-risk-high {
      color: #fecdd3;
      border-color: rgba(251, 113, 133, 0.45);
    }

    .principal-card-link {
      color: var(--accent-cornflower);
      text-decoration: underline;
    }

    .principal-interest-table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(15, 23, 42, 0.55);
      border-radius: 14px;
      overflow: hidden;
      font-size: 0.9rem;
    }

    .principal-interest-table th,
    .principal-interest-table td {
      padding: 0.7rem 0.85rem;
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
    }

    .principal-interest-table tbody tr:last-child td {
      border-bottom: none;
    }

    .principal-interest-badge {
      display: inline-block;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.45);
      color: rgba(165, 180, 252, 0.95);
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
    }

    .principal-export-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: space-between;
      align-items: center;
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.2);
      padding: 1rem 1.2rem;
    }

    .principal-status {
      color: rgba(226, 232, 240, 0.75);
      font-size: 0.85rem;
    }

    /* Board view */
    .board-shell {
      display: grid;
      gap: 2rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.16);
      padding: 2.2rem;
      box-shadow: var(--shadow-sm);
    }

    .board-header {
      display: grid;
      gap: 1.2rem;
    }

    .board-kicker {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--accent-gold);
    }

    .board-title {
      font-size: clamp(2.2rem, 3.2vw, 2.7rem);
    }

    .board-sub {
      color: rgba(226, 232, 240, 0.75);
      max-width: 70ch;
    }

    .board-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      background: rgba(96, 165, 250, 0.2);
      padding: 0.5rem 1rem;
      border-radius: 999px;
      color: var(--accent-cornflower);
      font-size: 0.85rem;
    }

    .board-layout {
      display: grid;
      gap: 1.6rem;
    }

    .board-section-title {
      font-size: 1.6rem;
      font-weight: 600;
    }

    .board-section-sub {
      color: rgba(226, 232, 240, 0.7);
      max-width: 60ch;
    }

    .board-officers-grid {
      display: grid;
      gap: 1.2rem;
    }

    @media (min-width: 960px) {
      .board-officers-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .board-card,
    .board-meeting-card {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.4rem;
      display: grid;
      gap: 0.75rem;
    }

    .board-role {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.14em;
      color: rgba(226, 232, 240, 0.6);
    }

    .board-name {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .board-contact {
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.75);
    }

    .board-focus-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .board-tag-pill {
      padding: 0.35rem 0.8rem;
      border-radius: 999px;
      background: rgba(96, 165, 250, 0.18);
      color: var(--accent-cornflower);
      font-size: 0.75rem;
    }

    .board-meeting-row {
      font-size: 0.92rem;
      color: rgba(226, 232, 240, 0.8);
    }

    .board-meeting-note {
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.7);
    }

    .board-docs-layout {
      display: grid;
      gap: 1.5rem;
    }

    @media (min-width: 960px) {
      .board-docs-layout {
        grid-template-columns: 2fr 1fr;
      }
    }

    .board-table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(15, 23, 42, 0.55);
      border-radius: 14px;
      overflow: hidden;
    }

    .board-table th,
    .board-table td {
      padding: 0.75rem 0.9rem;
      border-bottom: 1px solid rgba(148, 163, 184, 0.2);
      text-align: left;
    }

    .board-table tbody tr:last-child td {
      border-bottom: none;
    }

    .board-doc-link {
      color: var(--accent-cornflower);
      text-decoration: underline;
    }

    .board-doc-pill {
      display: inline-block;
      padding: 0.35rem 0.75rem;
      border-radius: 999px;
      background: rgba(52, 211, 153, 0.2);
      color: var(--accent-mint);
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.12em;
    }

    .board-action-card {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.5rem;
      display: grid;
      gap: 0.9rem;
    }

    .board-action-list {
      list-style: none;
      display: grid;
      gap: 0.7rem;
      padding: 0;
      margin: 0;
      color: rgba(226, 232, 240, 0.82);
    }

    .board-action-btn {
      align-self: flex-start;
      border-radius: 999px;
      padding: 0.6rem 1.2rem;
      background: linear-gradient(135deg, rgba(96, 165, 250, 0.4), rgba(52, 211, 153, 0.35));
      border: none;
      color: #0f172a;
      font-weight: 600;
      box-shadow: var(--shadow-sm);
    }

    /* Student view */
    .student-shell {
      display: grid;
      gap: 1.8rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.16);
      padding: 2rem;
      box-shadow: var(--shadow-sm);
    }

    .student-header {
      display: grid;
      gap: 0.9rem;
    }

    .student-kicker {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--accent-rose);
    }

    .student-title {
      font-size: clamp(2rem, 3vw, 2.5rem);
    }

    .student-sub {
      color: rgba(226, 232, 240, 0.75);
      max-width: 60ch;
    }

    .student-grid {
      display: grid;
      gap: 1.1rem;
    }

    @media (min-width: 960px) {
      .student-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .student-card {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.4rem;
      display: grid;
      gap: 0.8rem;
    }

    .student-card-title {
      display: flex;
      align-items: center;
      gap: 0.6rem;
      font-weight: 600;
    }

    .student-emoji {
      font-size: 1.4rem;
    }

    .student-list,
    .student-tips-list,
    .student-week-list {
      display: grid;
      gap: 0.5rem;
      margin: 0;
      padding-left: 1.1rem;
      color: rgba(226, 232, 240, 0.85);
    }

    .student-link-grid {
      display: grid;
      gap: 1rem;
    }

    @media (min-width: 860px) {
      .student-link-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .student-link-card {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.3rem;
      display: grid;
      gap: 0.7rem;
    }

    .student-link-card a {
      color: var(--accent-cornflower);
      font-weight: 600;
    }

    .student-footer-note {
      text-align: center;
      color: rgba(226, 232, 240, 0.7);
      font-size: 0.9rem;
    }

    /* Principal access modal alignment */
    .principal-access-dialog {
      background: rgba(15, 23, 42, 0.88);
      border-radius: var(--radius-md);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 2rem;
      max-width: min(520px, 92vw);
      display: grid;
      gap: 1rem;
      box-shadow: var(--shadow-lg);
    }

    .principal-access-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 1rem;
    }

    .principal-access-form {
      display: grid;
      gap: 0.9rem;
    }

    .principal-access-input {
      padding: 0.7rem 1rem;
      border-radius: 12px;
      border: 1px solid rgba(148, 163, 184, 0.25);
      background: rgba(15, 23, 42, 0.75);
      color: inherit;
    }

    .principal-access-submit {
      background: linear-gradient(135deg, #60a5fa, #34d399);
      border: none;
      color: #0f172a;
      border-radius: 999px;
      padding: 0.7rem 1.2rem;
      font-weight: 600;
    }

    .principal-access-secondary {
      background: rgba(15, 23, 42, 0.55);
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      padding: 0.65rem 1.1rem;
      color: rgba(226, 232, 240, 0.8);
    }

    .principal-access-status {
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.85);
      min-height: 1.2rem;
    }

    .principal-reset-section {
      display: grid;
      gap: 1.2rem;
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.2rem;
    }

    .principal-reset-steps {
      display: flex;
      gap: 0.6rem;
      list-style: none;
      margin: 0;
      padding: 0;
      font-size: 0.8rem;
      color: rgba(226, 232, 240, 0.6);
    }

    .principal-reset-steps li {
      padding: 0.45rem 0.75rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.55);
    }

    .principal-reset-steps li.active {
      background: rgba(96, 165, 250, 0.2);
      color: var(--accent-cornflower);
    }

    .principal-reset-flow {
      display: grid;
      gap: 1rem;
    }

    .principal-reset-step {
      display: grid;
      gap: 0.75rem;
    }

    .principal-reset-kit {
      background: rgba(15, 23, 42, 0.6);
      border-radius: 12px;
      padding: 1rem;
      border: 1px solid rgba(148, 163, 184, 0.25);
      display: grid;
      gap: 0.6rem;
    }

    .principal-reset-code {
      font-family: "JetBrains Mono", "Fira Mono", monospace;
      font-size: 1.2rem;
      letter-spacing: 0.3em;
    }

    .principal-reset-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.85rem;
      color: rgba(226, 232, 240, 0.75);
    }

    .principal-reset-tip {
      font-size: 0.8rem;
      color: rgba(226, 232, 240, 0.6);
    }

    .principal-reset-success {
      display: grid;
      gap: 0.8rem;
      text-align: center;
    }

    .principal-reset-celebrate {
      font-size: 2rem;
    }

    .principal-reset-newpass {
      display: inline-grid;
      gap: 0.4rem;
      justify-items: center;
      border-radius: 12px;
      padding: 0.8rem;
      background: rgba(15, 23, 42, 0.55);
      border: 1px solid rgba(148, 163, 184, 0.2);
    }

    .principal-reset-newpass code {
      font-family: "JetBrains Mono", "Fira Mono", monospace;
      letter-spacing: 0.2em;
      font-size: 1.05rem;
    }

    @media (max-width: 1040px) {
      .principal-sidebar {
        position: static;
      }
      .principal-page {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .family-vol-grid {
      display: grid;
      gap: 1.2rem;
    }

    @media (min-width: 960px) {
      .family-vol-grid {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .family-vol-card {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.4rem;
      display: grid;
      gap: 0.8rem;
    }

    .family-vol-list {
      margin: 0;
      padding-left: 1.2rem;
      display: grid;
      gap: 0.5rem;
      color: rgba(226, 232, 240, 0.85);
    }

    .family-resource-card ul {
      padding-left: 1.1rem;
      display: grid;
      gap: 0.45rem;
    }

    .board-doc-list,
    .student-tips-list {
      list-style: none;
      margin: 0;
      padding: 0;
    }

    .view [style*="color:#374151"],
    .view [style*="color:#4b5563"],
    .view [style*="color:#6b7280"],
    .view [style*="color:#1f2937"],
    .view [style*="color:#334155"],
    .view [style*="color:#475569"],
    .view [style*="color:#1e293b"] {
      color: rgba(226, 232, 240, 0.78) !important;
    }

    .student-tips {
      background: rgba(15, 23, 42, 0.6);
      border-radius: var(--radius-sm);
      border: 1px solid rgba(148, 163, 184, 0.18);
      padding: 1.4rem;
      display: grid;
      gap: 0.7rem;
    }
</style>
</head>
<body class="theme-family">
  <div class="portal-app">
    <div class="portal-layout">
      <aside class="portal-rail" aria-label="Portal navigation">
        <div class="portal-identity">
          <div class="portal-mark">RB</div>
          <div>
            <div class="portal-brand-text-main">Riverbend Elementary PTA Portal</div>
            <div class="portal-brand-text-sub">Family · Principal · Board · Students</div>
          </div>
        </div>
        <p class="portal-overview-text">
          See what’s happening this week, what’s coming up, and where you can jump in to help — all in a simple, parent-friendly view.
        </p>
        <div class="portal-view-switcher">
          <span class="portal-toggle-label">View as:</span>
          <button type="button" class="view-toggle-btn active" data-view-target="family-view" aria-pressed="true" aria-controls="family-view">
            <span>🌼</span> PTA Family
          </button>
          <button type="button" class="view-toggle-btn" data-view-target="principal-view" aria-pressed="false" aria-controls="principal-view">
            <span>🎓</span> Principal
          </button>
          <button type="button" class="view-toggle-btn" data-view-target="pta-board-view" aria-pressed="false" aria-controls="pta-board-view">
            <span>📝</span> PTA Board
          </button>
          <button type="button" class="view-toggle-btn" data-view-target="student-view" aria-pressed="false" aria-controls="student-view">
            <span>🎒</span> Students
          </button>
        </div>
        <div class="portal-rail-footer">
          Made for busy families. One place for every school event.
        </div>
      </aside>
      <main class="portal-main">
        <div class="view-stage">
      <section id="family-view" class="view active family-root" aria-hidden="false">
        <div class="family-shell">
          <div class="family-nav">
            <div class="family-nav-left">
              <div class="family-school-mark">PTA</div>
              <div>
                <div class="family-school-main">Riverbend Elementary</div>
                <div class="family-school-sub">Parent–Teacher Association</div>
              </div>
            </div>
            <nav class="family-nav-links">
              <a href="#family-this-week">This Week</a>
              <a href="#family-upcoming">Upcoming</a>
              <a href="#family-volunteer">Volunteer</a>
              <a href="#family-resources">Resources</a>
              <a href="#family-info" class="family-nav-pill">Stay Informed</a>
            </nav>
          </div>

          <section class="family-hero">
            <div>
              <div class="family-hero-tag">
                <div class="family-hero-tag-dot"></div>
                <span>Made for busy families</span>
              </div>
              <h1 class="family-hero-title">
                One place for every <span>school event</span>.
              </h1>
              <p class="family-hero-sub">
                See what’s happening this week, what’s coming up, and where you can jump in to help —
                all in a simple, parent-friendly view.
              </p>
              <div class="family-hero-meta">
                <span><strong>Today:</strong> Quick snapshot of events</span>
                <span><strong>Green labels:</strong> Happening this week</span>
                <span><strong>Blue labels:</strong> Plan-ahead dates</span>
              </div>
              <div class="family-hero-actions">
                <button class="family-btn-primary"
                  onclick="document.getElementById('family-this-week').scrollIntoView({behavior:'smooth'})">
                  View this week’s events →
                </button>
                <button class="family-btn-ghost"
                  onclick="document.getElementById('family-upcoming').scrollIntoView({behavior:'smooth'})">
                  Jump to upcoming months
                </button>
              </div>
            </div>

            <aside class="family-today-card card-hover" aria-label="Today's overview">
              <div class="family-today-header">
                <div>
                  <div class="family-today-title">Today at a Glance</div>
                  <div class="family-today-date" id="family-today-date">Today’s date</div>
                </div>
              </div>
              <div class="family-today-pill">
                <div class="family-today-pill-dot"></div>
                <span>Happening today</span>
              </div>
              <ul class="family-today-list">
                <li>
                  <div class="family-today-item-title">Book Fair – Family Shopping Night</div>
                  <div class="family-today-item-meta">
                    5:00 – 7:30 PM · School Library
                  </div>
                </li>
                <li>
                  <div class="family-today-item-title">PTA General Meeting (Hybrid)</div>
                  <div class="family-today-item-meta">
                    7:00 – 8:00 PM · Media Center &amp; Zoom
                  </div>
                </li>
                <li>
                  <div class="family-today-item-title">Walk &amp; Roll to School Day meetup</div>
                  <div class="family-today-item-meta">
                    7:10 – 7:45 AM · Front parking lot check-in tent
                  </div>
                </li>
              </ul>
              <div class="family-today-note">
                Running late? Text the PTA hotline at <a class="portal-inline-link" href="sms:+15551234567">(555)
                  123-4567</a> and a volunteer will save you a seat or check in your student badge.
              </div>
            </aside>
          </section>

          <section id="family-this-week" class="family-section">
            <div class="family-section-header">
              <div>
                <div class="family-section-kicker">This Week</div>
                <h2 class="family-section-title">Events happening now.</h2>
              </div>
              <p class="family-section-sub">
                Green “This week” labels mean these are current events. If you only have a few minutes,
                this is the section to scan.
              </p>
            </div>

            <div class="family-filters" role="toolbar" aria-label="Filter this week's events">
              <button class="family-filter-pill active" type="button" data-filter="all" aria-pressed="true">
                All this week
              </button>
              <button class="family-filter-pill" type="button" data-filter="evening" aria-pressed="false">
                Evening events
              </button>
              <button class="family-filter-pill" type="button" data-filter="students" aria-pressed="false">
                For students
              </button>
              <button class="family-filter-pill" type="button" data-filter="grownups" aria-pressed="false">
                For grown-ups
              </button>
            </div>



            <div class="family-events-grid fade-seq">
              <article class="family-event-card card-hover" data-categories="evening,families">
                <div class="family-event-badges">
                  <span class="family-event-badge family-event-badge--today">Today</span>
                  <span class="family-event-badge">This week</span>
                </div>
                <h3 class="family-event-title">Book Fair – Family Shopping Night</h3>
                <div class="family-event-meta">
                  <span>📅 Tuesday, 5:00 – 7:30 PM</span>
                  <span>📍 School Library</span>
                </div>
                <p class="family-event-note">
                  Teacher wish-lists are posted by grade level. Cash, card, and e-wallet accepted. PTA readers are
                  available for younger students.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Family event</span>
                  <span class="family-event-tag-pill">Fundraiser</span>
                </div>
              </article>

              <article class="family-event-card card-hover" data-categories="students,morning">
                <div class="family-event-badges">
                  <span class="family-event-badge">This week</span>
                </div>
                <h3 class="family-event-title">Walk &amp; Roll to School Day</h3>
                <div class="family-event-meta">
                  <span>📅 Wednesday, 7:10 – 7:45 AM</span>
                  <span>📍 Front parking lot</span>
                </div>
                <p class="family-event-note">
                  Meet at the blue PTA tent for stickers and hot cocoa. Volunteers will lead walking groups down Park
                  Avenue and River Trail.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Health &amp; wellness</span>
                  <span class="family-event-tag-pill">Students</span>
                </div>
              </article>

              <article class="family-event-card card-hover" data-categories="grownups,daytime">
                <div class="family-event-badges">
                  <span class="family-event-badge">This week</span>
                </div>
                <h3 class="family-event-title">Teacher Appreciation Snack Cart</h3>
                <div class="family-event-meta">
                  <span>📅 Thursday, 8:30 – 11:30 AM</span>
                  <span>📍 Staff lounge</span>
                </div>
                <p class="family-event-note">
                  Drop donations at morning car line or sign up for a restock shift in the <a class="portal-inline-link"
                    href="#family-volunteer">volunteer hub</a>. Gluten-free and caffeine-free options welcome.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Staff support</span>
                  <span class="family-event-tag-pill">Donations</span>
                </div>
              </article>

              <article class="family-event-card card-hover" data-categories="evening,grownups">
                <div class="family-event-badges">
                  <span class="family-event-badge">This week</span>
                </div>
                <h3 class="family-event-title">PTA Meeting &amp; Budget Q&amp;A</h3>
                <div class="family-event-meta">
                  <span>📅 Tuesday, 7:00 – 8:00 PM</span>
                  <span>📍 Media Center &amp; Zoom</span>
                </div>
                <p class="family-event-note">
                  Quick updates on fall fundraisers followed by an open Q&amp;A with the treasurer. Zoom link emailed at
                  noon; recordings posted within 24 hours.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Grown-up focus</span>
                  <span class="family-event-tag-pill">Finance</span>
                </div>
              </article>

              <article class="family-event-card card-hover" data-categories="students,after-school">
                <div class="family-event-badges">
                  <span class="family-event-badge">This week</span>
                </div>
                <h3 class="family-event-title">Chess Club Tournament Practice</h3>
                <div class="family-event-meta">
                  <span>📅 Thursday, 3:00 – 4:15 PM</span>
                  <span>📍 Innovation Lab</span>
                </div>
                <p class="family-event-note">
                  Open to 3rd–5th graders. Boards provided; bring a water bottle. Parents pick up at the car-rider loop at
                  4:20 PM.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Students</span>
                  <span class="family-event-tag-pill">Clubs</span>
                </div>
              </article>

              <article class="family-event-card card-hover" data-categories="grownups,daytime">
                <div class="family-event-badges">
                  <span class="family-event-badge">This week</span>
                </div>
                <h3 class="family-event-title">Lunchroom Buddy Express Shift</h3>
                <div class="family-event-meta">
                  <span>📅 Friday, 11:15 AM – 12:45 PM</span>
                  <span>📍 Cafeteria</span>
                </div>
                <p class="family-event-note">
                  Spend one lunch period helping younger grades open containers and clean up. Background check on file
                  required — complete it online if you haven’t yet.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Volunteer shift</span>
                  <span class="family-event-tag-pill">Grown-ups</span>
                </div>
              </article>
            </div>
          </section>

          <section id="family-upcoming" class="family-section">
            <div class="family-section-header">
              <div>
                <div class="family-section-kicker">Upcoming</div>
                <h2 class="family-section-title">Events to plan ahead for.</h2>
              </div>
              <p class="family-section-sub">
                These dates are a little further out. Add them to your calendar now so nothing sneaks up on you.
              </p>
            </div>

            <div class="family-events-grid fade-seq">
              <article class="family-event-card card-hover">
                <div class="family-event-badges">
                  <span class="family-event-badge">Next week</span>
                </div>
                <h3 class="family-event-title">Fall Family Movie Night</h3>
                <div class="family-event-meta">
                  <span>📅 Friday, 6:30 – 8:30 PM</span>
                  <span>📍 Gymnasium</span>
                </div>
                <p class="family-event-note">
                  Bring blankets and lawn chairs. Concessions will be available (cash and card).
                  Children must be accompanied by an adult.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Family event</span>
                  <span class="family-event-tag-pill">PTA fundraiser</span>
                </div>
              </article>

              <article class="family-event-card card-hover">
                <div class="family-event-badges">
                  <span class="family-event-badge">Later this month</span>
                </div>
                <h3 class="family-event-title">STEM Night &amp; Classroom Showcase</h3>
                <div class="family-event-meta">
                  <span>📅 Thursday, 6:00 – 7:30 PM</span>
                  <span>📍 Classrooms &amp; Cafeteria</span>
                </div>
                <p class="family-event-note">
                  Hands-on science and technology stations around the building. Great opportunity
                  to see classroom projects and meet other families.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Academics</span>
                  <span class="family-event-tag-pill">Hands-on</span>
                </div>
              </article>

              <article class="family-event-card card-hover">
                <div class="family-event-badges">
                  <span class="family-event-badge">Next month</span>
                </div>
                <h3 class="family-event-title">Winter Concert &amp; Art Walk</h3>
                <div class="family-event-meta">
                  <span>📅 Date TBA (evening)</span>
                  <span>📍 Auditorium &amp; Hallways</span>
                </div>
                <p class="family-event-note">
                  Student performances followed by an art walk featuring work from all grade levels.
                  Exact date will be shared once confirmed.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Fine arts</span>
                  <span class="family-event-tag-pill">Families welcome</span>
                </div>
              </article>

              <article class="family-event-card card-hover">
                <div class="family-event-badges">
                  <span class="family-event-badge">Early November</span>
                </div>
                <h3 class="family-event-title">Holiday Giving Tree Kickoff</h3>
                <div class="family-event-meta">
                  <span>📅 Monday, Nov 4 – Friday, Nov 15</span>
                  <span>📍 Front office lobby</span>
                </div>
                <p class="family-event-note">
                  Pick an ornament with a requested item for a Riverbend family. Gifts are returned unwrapped by Nov 15 so
                  counselors can distribute them before break.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Community care</span>
                  <span class="family-event-tag-pill">Donations</span>
                </div>
              </article>

              <article class="family-event-card card-hover">
                <div class="family-event-badges">
                  <span class="family-event-badge">Next month</span>
                </div>
                <h3 class="family-event-title">Community Garden Clean-Up Day</h3>
                <div class="family-event-meta">
                  <span>📅 Saturday, Nov 9 · 9:00 – 11:30 AM</span>
                  <span>📍 School garden (behind cafeteria)</span>
                </div>
                <p class="family-event-note">
                  Bring garden gloves and water bottles. PTA provides tools and snacks. Great for families who like hands-on
                  projects.
                </p>
                <div class="family-event-tags">
                  <span class="family-event-tag-pill">Outdoor</span>
                  <span class="family-event-tag-pill">All ages</span>
                </div>
              </article>
            </div>
          </section>

          <section id="family-volunteer" class="family-section">
            <div class="family-section-header">
              <div>
                <div class="family-section-kicker">Volunteer &amp; Sign-ups</div>
                <h2 class="family-section-title">Ways to help (big and small).</h2>
              </div>
              <p class="family-section-sub">
                You do not have to be “on the board” to help. A single hour makes a real difference.
                Choose what fits your week.
              </p>
            </div>

            <div class="family-vol-grid fade-seq">
              <div class="family-vol-card card-hover">
                <strong>This week’s needs</strong>
                <ul class="family-vol-list">
                  <li>Book Fair: 30-minute check-out helpers (evening slots).</li>
                  <li>Walk &amp; Roll Day: 3 adults to help at crosswalks from 7:10–7:40 AM.</li>
                  <li>Snack Cart: bottled water, granola bars, single-serve tea/coffee pods.</li>
                </ul>
                <p style="margin-top:0.7rem;">
                  To sign up, please use the PTA e-mail below or the sign-up links shared in the
                  weekly newsletter. It’s always okay to bring younger siblings with you.
                </p>
                <a class="family-btn-primary" style="margin-top:0.8rem;" href="https://riverbendpta.example.org/volunteer-signup"
                  target="_blank" rel="noopener">
                  Open volunteer sign-up form
                </a>
              </div>

              <div class="family-vol-card card-hover">
                <strong>Low-pressure ways to support</strong>
                <ul class="family-vol-list">
                  <li>Share PTA events in your classroom chats or carpool groups.</li>
                  <li>Ask your workplace about matching gifts for school fundraisers.</li>
                  <li>Drop a thank-you note in the office for a favorite staff member.</li>
                  <li>Attend one PTA meeting this semester to stay in the loop.</li>
                </ul>
                <p style="margin-top:0.7rem; font-size:0.8rem; color:#6b7280;">
                  There is no minimum time commitment. Your presence at events already counts as support.
                </p>
              </div>

              <div class="family-vol-card card-hover">
                <strong>Recurring opportunities</strong>
                <ul class="family-vol-list">
                  <li>
                    <a class="portal-inline-link" href="https://riverbendpta.example.org/signup/lunchroom" target="_blank"
                      rel="noopener">Lunchroom Buddy rotation</a> · 45-minute shifts assisting grades K–2.
                  </li>
                  <li>
                    <a class="portal-inline-link" href="https://riverbendpta.example.org/signup/library" target="_blank"
                      rel="noopener">Library shelving crew</a> · help Mrs. Owens re-shelve books on Fridays.
                  </li>
                  <li>
                    <a class="portal-inline-link" href="https://riverbendpta.example.org/signup/garden" target="_blank"
                      rel="noopener">Garden keepers</a> · adopt a planter box for monthly watering and weeding.
                  </li>
                </ul>
                <p style="margin-top:0.7rem; font-size:0.8rem;">
                  Need to update your background check? Complete the district form at
                  <a class="portal-inline-link" href="https://riverbendpta.example.org/background-check" target="_blank"
                    rel="noopener">riverbendpta.example.org/background-check</a> before your first shift.
                </p>
              </div>
            </div>
          </section>

          <section id="family-info" class="family-section">
            <div class="family-section-header">
              <div>
                <div class="family-section-kicker">Stay Informed</div>
                <h2 class="family-section-title">Never miss an event reminder.</h2>
              </div>
            </div>

            <div class="family-info-card card-hover" id="family-info-card">
              <strong>Choose at least one way to stay updated:</strong>
              <div class="family-info-row">
                <div>
                  <strong>📧 Weekly PTA e-mail</strong>
                  <p style="margin-top:0.35rem; font-size:0.8rem; color:#374151;">
                    Sent on Sunday evenings with highlights for the coming week, direct links to sign-ups, and any forms due soon.
                  </p>
                </div>
                <div>
                  <strong>📱 Text alerts</strong>
                  <p style="margin-top:0.35rem; font-size:0.8rem; color:#374151;">
                    Same-day nudges such as “Movie Night tonight at 6:30 PM.” Opt out anytime by replying STOP.
                  </p>
                </div>
                <div>
                  <strong>📆 Shared calendar</strong>
                  <p style="margin-top:0.35rem; font-size:0.8rem; color:#374151;">
                    Subscribe once and every PTA event appears on your phone and computer calendars automatically.
                  </p>
                </div>
              </div>
              <div class="family-info-actions">
                <button class="family-link-btn" type="button" id="family-request-email-btn">
                  Request weekly e-mails
                </button>
                <button class="family-link-btn" type="button" id="family-text-alert-btn">
                  Join text alerts
                </button>
                <button class="family-link-btn" type="button" id="family-calendar-btn">
                  Download calendar (.ics)
                </button>
              </div>
              <div class="family-feedback" id="family-info-feedback" role="status" aria-live="polite" hidden></div>
              <p style="margin-top:0.8rem; font-size:0.78rem; color:#4b5563;">
                Questions? Reply to any update or e-mail <a class="portal-inline-link" href="mailto:pta@riverbendelementary.org">pta@riverbendelementary.org</a>.
                We can add grandparents or caregivers too.
              </p>
            </div>

            <section id="family-resources" class="family-section" aria-label="Family resources and downloads">
              <div class="family-section-header">
                <div>
                  <div class="family-section-kicker">Quick resources</div>
                  <h2 class="family-section-title">Helpful guides, forms, and how-tos.</h2>
                </div>
                <p class="family-section-sub">
                  Save or share these cheat sheets whenever a new event pops up. They’re updated as details change.
                </p>
              </div>

              <div class="family-resource-grid fade-seq">
                <article class="family-resource-card card-hover" id="family-checklist">
                  <strong>Family event checklist</strong>
                  <ul>
                    <li><a class="portal-inline-link" href="https://riverbendpta.example.org/checklists/family-night.pdf" target="_blank" rel="noopener">Family Night printable checklist (PDF)</a></li>
                    <li>Includes suggested arrival times, what to bring, and student pick-up notes.</li>
                  </ul>
                </article>

                <article class="family-resource-card card-hover" id="family-calendar">
                  <strong>Master calendar &amp; reminders</strong>
                  <ul>
                    <li><a class="portal-inline-link" href="https://riverbendpta.example.org/calendar" target="_blank" rel="noopener">View the interactive PTA calendar</a></li>
                    <li>Syncs automatically with Google, Apple, and Outlook once added.</li>
                  </ul>
                </article>

                <article class="family-resource-card card-hover" id="family-forms">
                  <strong>Forms &amp; contacts</strong>
                  <ul>
                    <li><a class="portal-inline-link" href="https://riverbendpta.example.org/forms/reimbursement.pdf" target="_blank" rel="noopener">Reimbursement request (PDF)</a></li>
                    <li><a class="portal-inline-link" href="mailto:roomparents@riverbendpta.example.org">Room parent coordinator</a> · share classroom-specific questions.</li>
                  </ul>
                </article>
              </div>
            </section>
          </section>
        </div>

        <footer class="family-footer">
          <div class="family-footer-inner">
            <div>© <span id="family-year"></span> Riverbend Elementary PTA · For questions, e-mail <strong>pta@riverbendelementary.org</strong></div>
            <div class="family-footer-links">
              <a href="#family-this-week">This week</a>
              <a href="#family-upcoming">Upcoming</a>
              <a href="#family-volunteer">Volunteer</a>
              <a href="#family-resources">Resources</a>
            </div>
          </div>
        </footer>
      </section>

      <!-- ================= PRINCIPAL VIEW ================= -->
      <section id="principal-view" class="view principal-root" hidden aria-hidden="true">
        <div class="principal-page">
          <aside class="principal-sidebar">
            <div class="principal-logo">RB</div>
            <div class="principal-school-name">Riverbend Elementary</div>
            <div class="principal-role">Principal dashboard · PTA events</div>

            <div class="principal-sidebar-title">View</div>
            <ul class="principal-nav-list">
              <li class="principal-nav-item">
                <button type="button" class="principal-nav-link active" data-panel-target="this-week" aria-pressed="true">
                  <span>This week</span>
                  <span>5 events</span>
                </button>
              </li>
              <li class="principal-nav-item">
                <button type="button" class="principal-nav-link" data-panel-target="next-30" aria-pressed="false">
                  <span>Next 30 days</span>
                  <span>12 events</span>
                </button>
              </li>
              <li class="principal-nav-item">
                <button type="button" class="principal-nav-link" data-panel-target="by-grade" aria-pressed="false">
                  <span>By grade level</span>
                  <span>Overview</span>
                </button>
              </li>
            </ul>

            <div class="principal-sidebar-title">Quick checks</div>
            <ul class="principal-nav-list">
              <li class="principal-nav-item">
                <button type="button" class="principal-nav-link" data-panel-force="this-week"
                  data-scroll-target="#principal-volunteer-card" data-highlight-target="#principal-volunteer-card">
                  <span>Volunteer coverage</span>
                  <span>2 low</span>
                </button>
              </li>
              <li class="principal-nav-item">
                <button type="button" class="principal-nav-link" data-panel-force="this-week"
                  data-scroll-target="#principal-events-card" data-filter-timing="evening"
                  data-quick-message="Filtered to evening events for this week.">
                  <span>Evening events</span>
                  <span>3 this week</span>
                </button>
              </li>
              <li class="principal-nav-item">
                <button type="button" class="principal-nav-link" data-panel-force="this-week"
                  data-scroll-target="#principal-load-card" data-highlight-target="#principal-load-card"
                  data-quick-message="Review building load and staffing balance.">
                  <span>Building load</span>
                  <span>Balanced</span>
                </button>
              </li>
            </ul>

            <div class="principal-sidebar-note">
              This dashboard summarizes PTA activity so you can spot busy nights,
              staffing gaps, and parent interest at a glance — without reading every flyer.
            </div>
          </aside>

          <main class="principal-main">
            <div class="principal-locked-banner" id="principal-locked-banner" hidden>
              Principal access required. Enter the password to unlock this view.
            </div>
            <header class="principal-header">
              <div class="principal-title-block">
                <div class="principal-kicker" id="principal-view-kicker">This Week · Snapshot</div>
                <h1 class="principal-title" id="principal-view-title">PTA events and building impact</h1>
                <p class="principal-sub" id="principal-view-sub">
                  Current week overview. Green means comfortably covered, orange needs a second look,
                  red means something may need to move or get extra support.
                </p>
              </div>
              <div class="principal-controls">
                <button class="principal-btn-ghost" type="button" id="principal-manage-access">
                  Manage access
                </button>
                <span class="principal-date-pill" id="principal-date-pill">Week of —</span>
                <button class="principal-btn-outline" type="button" id="principal-filter-btn" aria-expanded="false">
                  Adjust filters
                </button>
                <button class="principal-btn-solid" type="button" id="principal-export-btn">
                  Export snapshot
                </button>
              </div>
            </header>
            <p class="principal-status-message" id="principal-status-message" role="status" aria-live="polite"></p>

            <div class="principal-filter-overlay" id="principal-filter-overlay" hidden>
              <div class="principal-filter-panel" role="dialog" aria-modal="true"
                aria-labelledby="principal-filter-heading">
                <div class="principal-filter-header">
                  <h2 id="principal-filter-heading">Adjust event filters</h2>
                  <button type="button" class="principal-filter-close" id="principal-filter-close">Close</button>
                </div>
                <form id="principal-filter-form">
                  <fieldset class="principal-filter-group">
                    <legend>Focus areas</legend>
                    <div class="principal-filter-options">
                      <label class="principal-filter-option" for="principal-filter-family">
                        <input type="checkbox" id="principal-filter-family" name="focus" value="family" checked />
                        Family events
                      </label>
                      <label class="principal-filter-option" for="principal-filter-staff">
                        <input type="checkbox" id="principal-filter-staff" name="focus" value="staff" checked />
                        Staff support
                      </label>
                      <label class="principal-filter-option" for="principal-filter-students">
                        <input type="checkbox" id="principal-filter-students" name="focus" value="students" checked />
                        Student-facing
                      </label>
                      <label class="principal-filter-option" for="principal-filter-community">
                        <input type="checkbox" id="principal-filter-community" name="focus" value="community" checked />
                        Community / fundraising
                      </label>
                    </div>
                  </fieldset>
                  <fieldset class="principal-filter-group">
                    <legend>Timing</legend>
                    <div class="principal-filter-options">
                      <label class="principal-filter-option" for="principal-filter-morning">
                        <input type="checkbox" id="principal-filter-morning" name="timing" value="morning" checked />
                        Morning
                      </label>
                      <label class="principal-filter-option" for="principal-filter-schoolday">
                        <input type="checkbox" id="principal-filter-schoolday" name="timing" value="schoolday" checked />
                        School day
                      </label>
                      <label class="principal-filter-option" for="principal-filter-evening">
                        <input type="checkbox" id="principal-filter-evening" name="timing" value="evening" checked />
                        Evening
                      </label>
                    </div>
                  </fieldset>
                  <div class="principal-filter-actions">
                    <button type="button" class="principal-btn-outline" id="principal-filter-reset">Reset</button>
                    <button type="submit" class="principal-btn-solid">Apply filters</button>
                  </div>
                </form>
              </div>
            </div>

            <div class="principal-panel active" data-panel="this-week" id="principal-panel-this-week">
              <section class="principal-summary-grid" aria-label="Summary metrics for this week">
              <article class="principal-summary-card card-hover" style="--fill:70%;">
                <div class="principal-summary-label">Total events (Sun–Sat)</div>
                <div class="principal-summary-value">5</div>
                <div class="principal-summary-chip">2 student-facing · 3 family/teacher</div>
                <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
              </article>

              <article class="principal-summary-card card-hover" style="--fill:60%;">
                <div class="principal-summary-label">Evening events</div>
                <div class="principal-summary-value">3</div>
                <div class="principal-summary-chip">Within typical range</div>
                <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
              </article>

              <article class="principal-summary-card card-hover" style="--fill:45%;">
                <div class="principal-summary-label">Volunteer coverage</div>
                <div class="principal-summary-value">~65%</div>
                <div class="principal-summary-chip">2 events under 50% staffed</div>
                <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
              </article>

              <article class="principal-summary-card card-hover" style="--fill:55%;">
                <div class="principal-summary-label">Building load</div>
                <div class="principal-summary-value">Moderate</div>
                <div class="principal-summary-chip">No back-to-back late nights</div>
                <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
              </article>
              </section>

              <section class="principal-full-card" aria-label="Detailed list of this week's events">
                <article class="principal-card card-hover" id="principal-events-card">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">This week’s event roster</div>
                      <div class="principal-card-sub">Filter to see the events that need your attention.</div>
                    </div>
                    <div class="principal-small" id="principal-events-count">Showing 5 of 5 events</div>
                  </header>

                  <p class="principal-small">
                    Use the filters to focus on student-facing events, staffing needs, or evening commitments.
                  </p>

                  <table class="principal-event-table" id="principal-event-table">
                    <thead>
                      <tr>
                        <th scope="col">Event</th>
                        <th scope="col">When</th>
                        <th scope="col">Focus</th>
                        <th scope="col">Notes</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr data-focus="family,community" data-timing="evening">
                        <td>Book Fair — Family Night</td>
                        <td>Tue · 5:00 – 7:30 PM</td>
                        <td><span class="principal-event-pill">Family · Fundraiser</span></td>
                        <td>Coverage comfortable — confirm cash box pickup at 4:30 PM.</td>
                      </tr>
                      <tr data-focus="students" data-timing="morning">
                        <td>Walk &amp; Roll to School Day</td>
                        <td>Wed · 7:10 – 7:45 AM</td>
                        <td><span class="principal-event-pill">Student-facing</span></td>
                        <td>Needs two additional crosswalk adults.</td>
                      </tr>
                      <tr data-focus="staff" data-timing="schoolday">
                        <td>Teacher Snack Cart</td>
                        <td>Thu · 8:30 – 11:30 AM</td>
                        <td><span class="principal-event-pill">Staff support</span></td>
                        <td>Check storage space for extra donations arriving Wednesday.</td>
                      </tr>
                      <tr data-focus="students" data-timing="schoolday">
                        <td>Chess Club Tournament Practice</td>
                        <td>Thu · 3:00 – 4:15 PM</td>
                        <td><span class="principal-event-pill">Student enrichment</span></td>
                        <td>Confirm dismissal coverage for car-rider loop at 4:20 PM.</td>
                      </tr>
                      <tr data-focus="family,community" data-timing="evening">
                        <td>PTA Meeting &amp; Budget Q&amp;A</td>
                        <td>Tue · 7:00 – 8:00 PM</td>
                        <td><span class="principal-event-pill">Family · Governance</span></td>
                        <td>Hybrid option open; watch for Zoom chat questions during finance report.</td>
                      </tr>
                    </tbody>
                  </table>

                  <p class="principal-inline-note principal-small">
                    Exporting a snapshot saves these rows so you can share them with APs or office staff.
                  </p>
                </article>
              </section>

              <section class="principal-grid-2">
                <article class="principal-card card-hover" id="principal-load-card" aria-label="Event load by weekday">
                <header class="principal-card-header">
                  <div>
                    <div class="principal-card-title">Event load by weekday</div>
                    <div class="principal-card-sub">
                      Helps avoid overloading the same night each week.
                    </div>
                  </div>
                  <div class="principal-small">This week only</div>
                </header>

                <div class="principal-week-load">
                  <div class="principal-day-col">
                    <div class="principal-day-bar-wrapper">
                      <div class="principal-day-bar" style="--height:35%;"></div>
                    </div>
                    <div class="principal-day-label">Mon</div>
                    <div class="principal-day-count">1 event</div>
                  </div>
                  <div class="principal-day-col">
                    <div class="principal-day-bar-wrapper">
                      <div class="principal-day-bar" style="--height:70%;"></div>
                    </div>
                    <div class="principal-day-label">Tue</div>
                    <div class="principal-day-count">2 events</div>
                  </div>
                  <div class="principal-day-col">
                    <div class="principal-day-bar-wrapper">
                      <div class="principal-day-bar" style="--height:35%;"></div>
                    </div>
                    <div class="principal-day-label">Wed</div>
                    <div class="principal-day-count">1 event</div>
                  </div>
                  <div class="principal-day-col">
                    <div class="principal-day-bar-wrapper">
                      <div class="principal-day-bar" style="--height:35%;"></div>
                    </div>
                    <div class="principal-day-label">Thu</div>
                    <div class="principal-day-count">1 event</div>
                  </div>
                  <div class="principal-day-col">
                    <div class="principal-day-bar-wrapper">
                      <div class="principal-day-bar" style="--height:10%; opacity:0.4;"></div>
                    </div>
                    <div class="principal-day-label">Fri</div>
                    <div class="principal-day-count">0 events</div>
                  </div>
                </div>

                <p class="principal-small" style="margin-top:0.55rem;">
                  Note: Tuesday is the busiest night (PTA Meeting + Book Fair evening). If you see more than
                  3 events on one weekday, consider spacing new requests.
                </p>
              </article>

              <article class="principal-card card-hover" id="principal-volunteer-card" aria-label="Volunteer coverage by event">
                <header class="principal-card-header">
                  <div>
                    <div class="principal-card-title">Volunteer coverage</div>
                    <div class="principal-card-sub">
                      Where the PTA could use extra staff or admin support.
                    </div>
                  </div>
                </header>

                <ul class="principal-coverage-list">
                  <li class="principal-coverage-item">
                    <span class="principal-coverage-label">Book Fair — Family Night</span>
                    <div class="principal-coverage-meter" style="--fill:80%;">
                      <div class="principal-coverage-fill"></div>
                    </div>
                    <span class="principal-coverage-status">Comfortable</span>
                  </li>
                  <li class="principal-coverage-item">
                    <span class="principal-coverage-label">Walk &amp; Roll to School</span>
                    <div class="principal-coverage-meter" style="--fill:45%;">
                      <div class="principal-coverage-fill"></div>
                    </div>
                    <span class="principal-coverage-status">Needs 2 adults</span>
                  </li>
                  <li class="principal-coverage-item">
                    <span class="principal-coverage-label">Teacher Snack Cart</span>
                    <div class="principal-coverage-meter" style="--fill:35%;">
                      <div class="principal-coverage-fill"></div>
                    </div>
                    <span class="principal-coverage-status">Low coverage</span>
                  </li>
                  <li class="principal-coverage-item">
                    <span class="principal-coverage-label">After-school Club Support</span>
                    <div class="principal-coverage-meter" style="--fill:70%;">
                      <div class="principal-coverage-fill"></div>
                    </div>
                    <span class="principal-coverage-status">On track</span>
                  </li>
                </ul>

                <p class="principal-small" style="margin-top:0.6rem;">
                  A quick e-mail or morning announcement from the office often fills the last few
                  volunteer spots faster than another flyer.
                </p>
              </article>
            </section>

              <section class="principal-grid-3" aria-label="Parent interest and scheduling risks">
              <article class="principal-card card-hover">
                <header class="principal-card-header">
                  <div>
                    <div class="principal-card-title">Parent interest (informal signals)</div>
                    <div class="principal-card-sub">
                      Based on RSVP forms, hallway chatter, and PTA feedback — not a formal survey.
                    </div>
                  </div>
                </header>

                <table class="principal-interest-table">
                  <thead>
                    <tr>
                      <th>Event</th>
                      <th>Signal</th>
                      <th>Note</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>Fall Family Movie Night</td>
                      <td><span class="principal-interest-badge">High interest</span></td>
                      <td>Lots of “Are we doing this again?” comments.</td>
                    </tr>
                    <tr>
                      <td>PTA General Meeting</td>
                      <td><span class="principal-interest-badge" style="border-color:#f59e0b;color:#fed7aa;">Mixed</span></td>
                      <td>Parents prefer hybrid option &amp; shorter agenda.</td>
                    </tr>
                    <tr>
                      <td>STEM Night</td>
                      <td><span class="principal-interest-badge">High interest</span></td>
                      <td>Teachers &amp; parents excited, kids talk about it.</td>
                    </tr>
                    <tr>
                      <td>Snack Cart Drop-offs</td>
                      <td><span class="principal-interest-badge" style="border-color:#22c55e;color:#bbf7d0;">Steady</span></td>
                      <td>Low lift for families, high impact for staff.</td>
                    </tr>
                  </tbody>
                </table>

                <p class="principal-small" style="margin-top:0.6rem;">
                  High-interest events are good places to pilot new ideas — raffles, community partners,
                  or student showcases — because turnout is already strong.
                </p>
              </article>

              <article class="principal-card card-hover">
                <header class="principal-card-header">
                  <div>
                    <div class="principal-card-title">Scheduling &amp; fatigue watchlist</div>
                    <div class="principal-card-sub">
                      Helps prevent “too many nights at school in a row” for families and staff.
                    </div>
                  </div>
                </header>

                <ul class="principal-risk-list">
                  <li class="principal-risk-item">
                    <div class="principal-risk-tag-row">
                      <span>Tue evening stack</span>
                      <span class="principal-risk-level principal-risk-med">Medium</span>
                    </div>
                    <p class="principal-risk-text">
                      Book Fair evening + PTA Meeting the same night. <br />
                      ✅ Acceptable this week, but keep an eye on similar patterns.
                    </p>
                  </li>
                  <li class="principal-risk-item">
                    <div class="principal-risk-tag-row">
                      <span>Staff bandwidth</span>
                      <span class="principal-risk-level principal-risk-high">Higher</span>
                    </div>
                    <p class="principal-risk-text">
                      Teacher committees also meeting this week. <br />
                      Consider PTO/PTA covering more logistics so staff can leave on time.
                    </p>
                  </li>
                  <li class="principal-risk-item">
                    <div class="principal-risk-tag-row">
                      <span>Family time balance</span>
                      <span class="principal-risk-level principal-risk-low">Low</span>
                    </div>
                    <p class="principal-risk-text">
                      No Friday events and only one late-night this week — good for overall family balance.
                    </p>
                  </li>
                </ul>

                <p class="principal-small" style="margin-top:0.6rem;">
                  If you ever see multiple “Higher” risks in a week, that’s a good trigger to
                  pause new event approvals or ask PTA to regroup on timing.
                </p>
              </article>
            </section>

              <section class="principal-grid-2" aria-label="Action items and communication notes">
                <article class="principal-card card-hover">
                <header class="principal-card-header">
                  <div>
                    <div class="principal-card-title">Action items for the principal</div>
                    <div class="principal-card-sub">Quick wins that keep the week smooth.</div>
                  </div>
                </header>

                <ul class="principal-checklist">
                  <li>
                    Confirm building coverage for <strong>Friday Movie Night</strong> by looping in the evening custodian
                    team (reply-all to <a class="principal-card-link" href="mailto:operations@riverbendpta.example.org">operations@riverbendpta.example.org</a>).
                  </li>
                  <li>
                    Approve PTA table placement in the front lobby so families can check in for <strong>Walk &amp; Roll</strong>
                    and pick up reflective stickers.
                  </li>
                  <li>
                    Record a 30-second <strong>morning announcement shout-out</strong> to staff for the snack cart; PTA will
                    drop the script in your inbox by noon Tuesday.
                  </li>
                </ul>

                <p class="principal-micro-note">
                  Knock these out and volunteers can handle the rest. Each one removes a frequent “Can we get approval?”
                  e-mail.
                </p>
              </article>

              <article class="principal-card card-hover">
                <header class="principal-card-header">
                  <div>
                    <div class="principal-card-title">Communications &amp; facilities notes</div>
                    <div class="principal-card-sub">What the office team should know for newsletters and setups.</div>
                  </div>
                </header>

                <ul class="principal-checklist">
                  <li>
                    Add the <strong>Giving Tree kickoff</strong> to next week’s family newsletter with drop-off instructions and
                    counselor contact info.
                  </li>
                  <li>
                    Ensure <strong>gym floor covering</strong> is scheduled for Movie Night (submit request via
                    <a class="principal-card-link" href="https://district.example.org/facilities" target="_blank" rel="noopener">district facilities portal</a>).
                  </li>
                  <li>
                    Share <strong>bus loop reminder</strong> with staff: Walk &amp; Roll groups will use the main sidewalk so buses
                    should unload 5 minutes early on Wednesday.
                  </li>
                </ul>

                <p class="principal-micro-note">
                  PTA comms lead <a class="principal-card-link" href="mailto:vp.riverbendpta@example.org">vp.riverbendpta@example.org</a>
                  is ready to plug these into templates once you give the thumbs up.
                </p>
                </article>
              </section>
            </div>

            <div class="principal-panel" data-panel="next-30" id="principal-panel-next-30">
              <section class="principal-summary-grid" aria-label="Summary metrics for the next 30 days">
                <article class="principal-summary-card card-hover" style="--fill:65%;">
                  <div class="principal-summary-label">Total PTA touchpoints (30 days)</div>
                  <div class="principal-summary-value">18</div>
                  <div class="principal-summary-chip">7 evening commitments</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>

                <article class="principal-summary-card card-hover" style="--fill:52%;">
                  <div class="principal-summary-label">High-demand nights</div>
                  <div class="principal-summary-value">4</div>
                  <div class="principal-summary-chip">Watch Oct 17 · Nov 1</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>

                <article class="principal-summary-card card-hover" style="--fill:58%;">
                  <div class="principal-summary-label">Volunteer commitments</div>
                  <div class="principal-summary-value">82</div>
                  <div class="principal-summary-chip">Goal: 95 pledged</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>

                <article class="principal-summary-card card-hover" style="--fill:62%;">
                  <div class="principal-summary-label">Budget impact</div>
                  <div class="principal-summary-value">$6.4K</div>
                  <div class="principal-summary-chip">Book Fair + Giving Tree</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>
              </section>

              <section class="principal-grid-2" aria-label="Upcoming calendar and approvals">
                <article class="principal-card card-hover" id="principal-next30-calendar">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Next 30-day calendar highlights</div>
                      <div class="principal-card-sub">Key events that impact building use and staffing.</div>
                    </div>
                  </header>

                  <table class="principal-event-table" id="principal-next30-table">
                    <thead>
                      <tr>
                        <th scope="col">Event</th>
                        <th scope="col">Date &amp; time</th>
                        <th scope="col">Focus</th>
                        <th scope="col">Notes</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>STEM Night</td>
                        <td>Thu, Nov 7 · 6:00 – 8:00 PM</td>
                        <td><span class="principal-event-pill">Family · STEM</span></td>
                        <td>Finalize custodial overtime request by Oct 28.</td>
                      </tr>
                      <tr>
                        <td>Community Garden Clean-Up</td>
                        <td>Sat, Nov 9 · 9:00 – 11:30 AM</td>
                        <td><span class="principal-event-pill">Community</span></td>
                        <td>Order mulch delivery for Nov 8 (PTA covers cost).</td>
                      </tr>
                      <tr>
                        <td>Holiday Giving Tree Kickoff</td>
                        <td>Nov 4 – Nov 15</td>
                        <td><span class="principal-event-pill">Community care</span></td>
                        <td>Counselors confirming 12 families receiving support.</td>
                      </tr>
                      <tr>
                        <td>Teacher Conference Meals</td>
                        <td>Nov 18 – Nov 20</td>
                        <td><span class="principal-event-pill">Staff support</span></td>
                        <td>Catering deposit due Nov 8; confirm dietary list.</td>
                      </tr>
                      <tr>
                        <td>Winter Concert Support</td>
                        <td>Tue, Dec 3 · 5:30 – 8:30 PM</td>
                        <td><span class="principal-event-pill">Students &amp; families</span></td>
                        <td>Need ushers + sound volunteer assigned by Nov 20.</td>
                      </tr>
                    </tbody>
                  </table>

                  <p class="principal-small principal-inline-note">
                    Dates include district non-school days so you can plan custodial coverage and HVAC schedules.
                  </p>
                </article>

                <article class="principal-card card-hover">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Upcoming approvals &amp; deadlines</div>
                      <div class="principal-card-sub">Handle these early to avoid last-minute scrambles.</div>
                    </div>
                  </header>

                  <ul class="principal-checklist">
                    <li>Approve STEM Night vendor list (electric + robotics) by <strong>Oct 18</strong>.</li>
                    <li>Confirm gym access for the <strong>Nov 9 Garden Clean-Up</strong> rain plan.</li>
                    <li>Sign updated facilities agreement for <strong>Winter Concert</strong> stage lighting by Oct 30.</li>
                    <li>Review PTA reimbursement batch scheduled for <strong>Nov 12</strong> (Book Fair expenses).</li>
                  </ul>

                  <p class="principal-micro-note">
                    Once these approvals are logged, PTA officers can finalize communication and volunteer pushes.
                  </p>
                </article>
              </section>

              <section class="principal-grid-2" aria-label="Logistics and volunteer planning for next 30 days">
                <article class="principal-card card-hover">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Logistics watchlist (30 days)</div>
                      <div class="principal-card-sub">Spot friction points before they become emergencies.</div>
                    </div>
                  </header>

                  <ul class="principal-risk-list">
                    <li class="principal-risk-item">
                      <div class="principal-risk-tag-row">
                        <span>STEM Night exhibits</span>
                        <span class="principal-risk-level principal-risk-med">Medium</span>
                      </div>
                      <p class="principal-risk-text">Need final electricity map from vendors — PTA following up by Oct 21.</p>
                    </li>
                    <li class="principal-risk-item">
                      <div class="principal-risk-tag-row">
                        <span>Giving Tree storage</span>
                        <span class="principal-risk-level principal-risk-low">Low</span>
                      </div>
                      <p class="principal-risk-text">Stage closet reserved; request custodial key access for counselors.</p>
                    </li>
                    <li class="principal-risk-item">
                      <div class="principal-risk-tag-row">
                        <span>Winter concert load-out</span>
                        <span class="principal-risk-level principal-risk-med">Medium</span>
                      </div>
                      <p class="principal-risk-text">Coordinate custodians for chair reset by 8:30 PM on Dec 3.</p>
                    </li>
                  </ul>

                  <p class="principal-small principal-inline-note">
                    Invite AP Turner to the Nov 1 planning check-in so decisions can be made on the spot.
                  </p>
                </article>

                <article class="principal-card card-hover">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Volunteer pipeline</div>
                      <div class="principal-card-sub">Where PTA still needs a principal signal boost.</div>
                    </div>
                  </header>

                  <ul class="principal-checklist">
                    <li><strong>STEM Night</strong> — 6 of 10 classroom hosts confirmed; highlight during staff meeting.</li>
                    <li><strong>Conference Meals</strong> — catering covered, but need 4 dessert drop-offs (ask 4th grade families).</li>
                    <li><strong>Garden Clean-Up</strong> — scouts partnering; principal shout-out could add family turnout.</li>
                    <li><strong>Winter Concert</strong> — seek 2 bilingual greeters for newcomer families.</li>
                  </ul>

                  <p class="principal-micro-note">
                    A single paragraph in the Sunday family message typically fills these remaining slots.</p>
                </article>
              </section>
            </div>

            <div class="principal-panel" data-panel="by-grade" id="principal-panel-by-grade">
              <section class="principal-summary-grid" aria-label="Summary metrics by grade level">
                <article class="principal-summary-card card-hover" style="--fill:68%;">
                  <div class="principal-summary-label">Grades engaged this month</div>
                  <div class="principal-summary-value">6</div>
                  <div class="principal-summary-chip">Every grade has an event touchpoint</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>

                <article class="principal-summary-card card-hover" style="--fill:54%;">
                  <div class="principal-summary-label">Highest need grade</div>
                  <div class="principal-summary-value">3rd grade</div>
                  <div class="principal-summary-chip">STEM presenters running low</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>

                <article class="principal-summary-card card-hover" style="--fill:60%;">
                  <div class="principal-summary-label">Shared opportunities</div>
                  <div class="principal-summary-value">4</div>
                  <div class="principal-summary-chip">Cross-grade family events</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>

                <article class="principal-summary-card card-hover" style="--fill:48%;">
                  <div class="principal-summary-label">Open classroom requests</div>
                  <div class="principal-summary-value">8</div>
                  <div class="principal-summary-chip">Focus on K–1 classroom support</div>
                  <div class="principal-summary-bar"><div class="principal-summary-bar-fill"></div></div>
                </article>
              </section>

              <section class="principal-grid-2" aria-label="Grade-level focus overview">
                <article class="principal-card card-hover" id="principal-grade-table-card">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Grade-level spotlights</div>
                      <div class="principal-card-sub">Where PTA is partnering directly with each grade.</div>
                    </div>
                  </header>

                  <table class="principal-event-table" id="principal-grade-table">
                    <thead>
                      <tr>
                        <th scope="col">Grade</th>
                        <th scope="col">Upcoming highlight</th>
                        <th scope="col">PTA lead</th>
                        <th scope="col">Notes</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>K</td>
                        <td>Playground refresh helpers · Oct 18</td>
                        <td>Volunteer Chair</td>
                        <td>Need 2 more adults for paint touch-ups.</td>
                      </tr>
                      <tr>
                        <td>1st</td>
                        <td>Reading Buddies kickoff · Oct 24</td>
                        <td>Teacher Liaison</td>
                        <td>Principal welcome video requested for families.</td>
                      </tr>
                      <tr>
                        <td>2nd</td>
                        <td>Science lab docents · Oct 30</td>
                        <td>STEM Night Lead</td>
                        <td>Safety glasses inventory complete; confirm parent training slides.</td>
                      </tr>
                      <tr>
                        <td>3rd</td>
                        <td>STEM Night presenters · Nov 7</td>
                        <td>VP Programs</td>
                        <td>Short 3 presenters — ask classroom teachers for referrals.</td>
                      </tr>
                      <tr>
                        <td>4th</td>
                        <td>Walk &amp; Roll route leaders · Nov 6</td>
                        <td>Safety Chair</td>
                        <td>Staffing strong; send thank-you note post-event.</td>
                      </tr>
                      <tr>
                        <td>5th</td>
                        <td>Safety patrol breakfast · Nov 15</td>
                        <td>Treasurer</td>
                        <td>Awaiting principal approval for early cafeteria access.</td>
                      </tr>
                    </tbody>
                  </table>
                </article>

                <article class="principal-card card-hover">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Support requests by grade</div>
                      <div class="principal-card-sub">Quick wins that remove classroom friction.</div>
                    </div>
                  </header>

                  <ul class="principal-checklist">
                    <li><strong>K</strong> — request 2 lunch buddies for Oct 23 (introduce car-line volunteers).</li>
                    <li><strong>1st</strong> — need Spanish translation of Reading Buddies flyer.</li>
                    <li><strong>2nd</strong> — confirm science lab doors unlocked by 7:45 AM on Oct 30.</li>
                    <li><strong>3rd</strong> — principal shout-out in newsletter for STEM presenters.</li>
                    <li><strong>5th</strong> — approve PA system use for safety patrol breakfast announcements.</li>
                  </ul>

                  <p class="principal-micro-note">
                    These items align with SIP goals around literacy and family engagement — easy wins to highlight in reports.
                  </p>
                </article>
              </section>

              <section class="principal-grid-2" aria-label="Cross-grade opportunities and family engagement">
                <article class="principal-card card-hover">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Cross-grade opportunities</div>
                      <div class="principal-card-sub">Pair older helpers with younger grades for stronger turnout.</div>
                    </div>
                  </header>

                  <ul class="principal-checklist">
                    <li><strong>Buddy reading</strong> — 5th grade can rotate through 1st grade classes during conference week.</li>
                    <li><strong>Garden clean-up</strong> — Suggest 2nd + 4th grade combo teams for tool sharing.</li>
                    <li><strong>Spirit assemblies</strong> — Invite 3rd grade to host November assembly with student council.</li>
                    <li><strong>STEM Night welcome crew</strong> — pair kindergarten families with 5th grade ambassadors.</li>
                  </ul>

                  <p class="principal-micro-note">
                    Announce these pairings during the Oct 21 staff huddle so teachers can prep students.</p>
                </article>

                <article class="principal-card card-hover">
                  <header class="principal-card-header">
                    <div>
                      <div class="principal-card-title">Family engagement notes</div>
                      <div class="principal-card-sub">Signals from grade-level liaisons and PTA feedback forms.</div>
                    </div>
                  </header>

                  <ul class="principal-checklist">
                    <li>3rd grade families asking for more hands-on STEM previews — PTA filming lab teaser.</li>
                    <li>1st grade prefer earlier volunteer sign-ups; send November sheet by Oct 15.</li>
                    <li>5th grade parents offered to lead secondary transition Q&amp;A in December.</li>
                    <li>Kindergarten appreciates clear parking instructions; share map again week of Oct 16.</li>
                  </ul>

                  <p class="principal-micro-note">
                    Sharing these quick notes in your staff newsletter keeps teachers aligned with PTA messaging.</p>
                </article>
              </section>
            </div>
          </main>
        </div>
      </section>

      <!-- ================= PTA BOARD VIEW ================= -->
      <section id="pta-board-view" class="view board-root" hidden aria-hidden="true">
        <div class="board-shell">
          <header class="board-header">
            <div class="board-title-block">
              <div class="board-kicker">PTA Leadership</div>
              <h1 class="board-title">Board, meetings, and key documents.</h1>
              <p class="board-sub">
                A clear overview of who’s serving this year, when the board meets,
                and where to find bylaws and minutes — so families always know
                how decisions are made.
              </p>
            </div>
            <div>
              <div class="board-badge">
                ✅ Transparent · Organized · Parent-led
              </div>
            </div>
          </header>

          <section class="board-layout">
            <div>
              <h2 class="board-section-title">2024–2025 PTA Board</h2>
              <p class="board-section-sub">
                All positions are volunteer roles. You can contact any officer with questions
                or ideas — they’re here to represent families and support the school.
              </p>

              <div class="board-officers-grid fade-seq">
                <article class="board-card card-hover">
                  <div class="board-role">President</div>
                  <div class="board-name">Alex Johnson</div>
                  <div class="board-contact">📧 president.riverbendpta@example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Agenda &amp; priorities</span>
                    <span class="board-tag-pill">Principal liaison</span>
                  </div>
                </article>

                <article class="board-card card-hover">
                  <div class="board-role">Vice President</div>
                  <div class="board-name">Maria Lopez</div>
                  <div class="board-contact">📧 vp.riverbendpta@example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Events support</span>
                    <span class="board-tag-pill">Volunteer teams</span>
                  </div>
                </article>

                <article class="board-card card-hover">
                  <div class="board-role">Treasurer</div>
                  <div class="board-name">Jordan Kim</div>
                  <div class="board-contact">📧 treasurer.riverbendpta@example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Budget &amp; reports</span>
                    <span class="board-tag-pill">Fundraisers</span>
                  </div>
                </article>

                <article class="board-card card-hover">
                  <div class="board-role">Secretary</div>
                  <div class="board-name">Priya Patel</div>
                  <div class="board-contact">📧 secretary.riverbendpta@example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Minutes</span>
                    <span class="board-tag-pill">Bylaws &amp; records</span>
                  </div>
                </article>

                <article class="board-card card-hover">
                  <div class="board-role">Volunteer Chair</div>
                  <div class="board-name">Taylor Brooks</div>
                  <div class="board-contact">📧 volunteers.riverbendpta@example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Sign-ups</span>
                    <span class="board-tag-pill">Room parents</span>
                  </div>
                </article>

                <article class="board-card card-hover">
                  <div class="board-role">Teacher Liaison</div>
                  <div class="board-name">Ms. Lacey Reed</div>
                  <div class="board-contact">📧 lacey.reed@riverbendpta.example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Staff voice</span>
                    <span class="board-tag-pill">Classroom needs</span>
                  </div>
                </article>

                <article class="board-card card-hover">
                  <div class="board-role">Fundraising Chair</div>
                  <div class="board-name">Chris Alvarez</div>
                  <div class="board-contact">📧 fundraising.riverbendpta@example.org</div>
                  <div class="board-focus-tags">
                    <span class="board-tag-pill">Community partners</span>
                    <span class="board-tag-pill">Grants</span>
                  </div>
                </article>
              </div>
            </div>

            <aside class="board-meeting-card card-hover">
              <h2 class="board-section-title">Board meetings</h2>
              <div class="board-meeting-row">
                <strong>Schedule:</strong> 1st Tuesday of each month, 6:30–8:00 PM
              </div>
              <div class="board-meeting-row">
                <strong>Location:</strong> Media Center (hybrid option via Zoom when noted)
              </div>
              <div class="board-meeting-row">
                <strong>Who may attend:</strong> All interested parents, guardians, staff, and community members.
              </div>
              <p class="board-meeting-note">
                Time is reserved at the start of each meeting for questions and ideas from families.
                You do not need to be a “member” to listen in.
              </p>
            </aside>
          </section>

          <section class="board-docs-layout">
            <div>
              <h2 class="board-section-title">Bylaws &amp; key documents</h2>
              <p class="board-section-sub">
                These documents guide how the PTA operates. For official copies, please contact the Secretary.
              </p>

              <table class="board-table">
                <thead>
                  <tr>
                    <th>Document</th>
                    <th>Last updated</th>
                    <th>Type</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><a href="#doc-bylaws" class="board-doc-link">PTA Bylaws (current)</a></td>
                    <td>August 2024</td>
                    <td><span class="board-doc-pill">Bylaws</span></td>
                  </tr>
                  <tr>
                    <td><a href="#doc-budget" class="board-doc-link">2024–2025 Budget Overview</a></td>
                    <td>September 2024</td>
                    <td><span class="board-doc-pill">Finance</span></td>
                  </tr>
                  <tr>
                    <td><a href="#doc-minutes-sept" class="board-doc-link">September Meeting Minutes</a></td>
                    <td>September 10, 2024</td>
                    <td><span class="board-doc-pill">Minutes</span></td>
                  </tr>
                  <tr>
                    <td><a href="#doc-minutes-oct" class="board-doc-link">October Meeting Minutes</a></td>
                    <td>October 8, 2024</td>
                    <td><span class="board-doc-pill">Minutes</span></td>
                  </tr>
                  <tr>
                    <td><a href="#doc-audit" class="board-doc-link">Annual Financial Review Summary</a></td>
                    <td>July 2024</td>
                    <td><span class="board-doc-pill">Finance</span></td>
                  </tr>
                  <tr>
                    <td><a href="#doc-volunteer-handbook" class="board-doc-link">Volunteer Handbook</a></td>
                    <td>October 2024</td>
                    <td><span class="board-doc-pill">Reference</span></td>
                  </tr>
                </tbody>
              </table>

              <div class="board-doc-detail card-hover" id="doc-bylaws">
                <h3>PTA Bylaws (current)</h3>
                <p>Defines officer roles, meeting procedures, and how funds are approved.</p>
                <ul>
                  <li>Download: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/bylaws.pdf" target="_blank" rel="noopener">bylaws.pdf</a></li>
                  <li>Summary one-pager for quick reference: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/bylaws-cheatsheet.pdf" target="_blank" rel="noopener">cheatsheet</a></li>
                </ul>
              </div>

              <div class="board-doc-detail card-hover" id="doc-budget">
                <h3>2024–2025 Budget Overview</h3>
                <p>Shows projected income and expenses by category along with year-to-date actuals.</p>
                <ul>
                  <li>View spreadsheet: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/budget.xlsx" target="_blank" rel="noopener">budget.xlsx</a></li>
                  <li>Questions? E-mail <a class="portal-inline-link" href="mailto:treasurer.riverbendpta@example.org">treasurer.riverbendpta@example.org</a></li>
                </ul>
              </div>

              <div class="board-doc-detail card-hover" id="doc-minutes-sept">
                <h3>September Meeting Minutes</h3>
                <p>Approved during the October board meeting.</p>
                <ul>
                  <li>Download minutes: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/minutes-sept.pdf" target="_blank" rel="noopener">minutes-sept.pdf</a></li>
                  <li>Key votes: Movie Night budget increase, STEM Night co-lead approval.</li>
                </ul>
              </div>

              <div class="board-doc-detail card-hover" id="doc-minutes-oct">
                <h3>October Meeting Minutes</h3>
                <p>Draft shared for transparency; official approval happens at the November meeting.</p>
                <ul>
                  <li>Draft minutes: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/minutes-oct-draft.pdf" target="_blank" rel="noopener">minutes-oct-draft.pdf</a></li>
                  <li>Includes volunteer recognition list and fundraising progress chart.</li>
                </ul>
              </div>

              <div class="board-doc-detail card-hover" id="doc-audit">
                <h3>Annual Financial Review Summary</h3>
                <p>Independent audit verifying that income and expenses matched bank statements for 2023–2024.</p>
                <ul>
                  <li>Summary PDF: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/financial-review.pdf" target="_blank" rel="noopener">financial-review.pdf</a></li>
                  <li>Contact the audit committee at <a class="portal-inline-link" href="mailto:audit@riverbendpta.example.org">audit@riverbendpta.example.org</a></li>
                </ul>
              </div>

              <div class="board-doc-detail card-hover" id="doc-volunteer-handbook">
                <h3>Volunteer Handbook</h3>
                <p>A quick guide for new volunteers covering sign-in procedures, background checks, and event expectations.</p>
                <ul>
                  <li>Handbook PDF: <a class="portal-inline-link" href="https://riverbendpta.example.org/docs/volunteer-handbook.pdf" target="_blank" rel="noopener">volunteer-handbook.pdf</a></li>
                  <li>Printed copies available in the front office near the PTA mailbox.</li>
                </ul>
              </div>
            </div>

            <aside class="board-quick-card card-hover">
              <h2 class="board-section-title">How families can get involved in decisions</h2>
              <ul class="board-quick-list">
                <li>Attend at least one board or general meeting this year to see how things work.</li>
                <li>E-mail the President or any officer if you have a concern or idea for an event.</li>
                <li>Review bylaws and budget summary before the annual voting meeting.</li>
                <li>Join a short-term committee (for example, Movie Night, STEM Night, Book Fair).</li>
              </ul>
              <p style="font-size:0.78rem; color:#4b5563;">
                The goal is for PTA decisions to feel open, understandable, and collaborative —
                never like they’re happening “behind closed doors.”
              </p>
            </aside>
          </section>

          <section class="board-section" aria-label="PTA resource library" style="margin-top:2rem;">
            <h2 class="board-section-title">Resource library for board &amp; committee leads</h2>
            <p class="board-section-sub">
              These quick links keep everyone on the same page — share them with committee co-leads and room parents.
            </p>

            <div class="board-resource-grid fade-seq">
              <article class="board-resource-card card-hover">
                <strong>Grants &amp; sponsorship tracker</strong>
                <p>Live spreadsheet of pending business partnerships, district grants, and deadlines.</p>
                <a href="https://riverbendpta.example.org/resources/grants-tracker" target="_blank" rel="noopener">Open tracker</a>
              </article>

              <article class="board-resource-card card-hover">
                <strong>Communications toolkit</strong>
                <p>Templates for flyers, social posts, and morning announcements. Includes brand colors and logos.</p>
                <a href="https://riverbendpta.example.org/resources/comms-kit.zip" target="_blank" rel="noopener">Download toolkit</a>
              </article>

              <article class="board-resource-card card-hover">
                <strong>Room parent starter pack</strong>
                <p>Sample e-mails, budget request form, and timeline for fall and spring classroom events.</p>
                <a href="https://riverbendpta.example.org/resources/room-parent-pack.pdf" target="_blank" rel="noopener">View starter pack</a>
              </article>
            </div>
          </section>
        </div>
      </section>

      <!-- ================= STUDENT VIEW ================= -->
      <section id="student-view" class="view student-root" hidden aria-hidden="true">
        <div class="student-shell">
          <header class="student-header">
            <div class="student-kicker">For Students</div>
            <h1 class="student-title">
              What’s happening at <span>our school</span> this week? 🎉
            </h1>
            <p class="student-sub">
              This page is just for you. See the fun stuff that’s coming up and how you can join in.
            </p>
          </header>

          <section class="student-grid fade-seq">
            <article class="student-card card-hover">
              <div class="student-card-title">
                <span class="student-emoji">📅</span>
                This week’s fun things
              </div>
              <ul class="student-list">
                <li>
                  <strong>Book Fair Night</strong>
                  <span class="student-badge green">Today</span>
                  <br />
                  Come to the library with your grown-ups to look at books.
                  You can help pick classroom books from your teacher’s wish list.
                </li>
                <li>
                  <strong>Walk &amp; Roll to School</strong>
                  <span class="student-badge">Morning</span>
                  <br />
                  Meet other students and walk in together from the front parking lot.
                  Scooters and strollers are okay — just listen to the helpers.
                </li>
                <li>
                  <strong>Teacher Snack Cart</strong>
                  <br />
                  The PTA is surprising teachers with snacks.
                  If you see the cart, you can say “Thanks for teaching us!” 🧃
                </li>
                <li>
                  <strong>Chess Club Practice</strong>
                  <span class="student-badge">After school</span>
                  <br />
                  Meet in the Innovation Lab on Thursday. Bring a water bottle and practice matches your best moves.
                </li>
                <li>
                  <strong>Spirit Wear Friday</strong>
                  <span class="student-badge">All day</span>
                  <br />
                  Wear your Riverbend colors or favorite school shirt to earn house points for your class.
                </li>
              </ul>
            </article>

            <article class="student-card card-hover">
              <div class="student-card-title">
                <span class="student-emoji">👀</span>
                Coming up soon
              </div>
              <ul class="student-list">
                <li>
                  <strong>Family Movie Night</strong>
                  <br />
                  Wear comfy clothes, bring a blanket, and watch a movie in the gym.
                  You must come with a grown-up.
                </li>
                <li>
                  <strong>STEM Night</strong>
                  <br />
                  Try science and tech stations around the school.
                  You can show your family the projects you’ve been working on.
                </li>
                <li>
                  <strong>Winter Concert &amp; Art Walk</strong>
                  <br />
                  Sing, play instruments, or show your artwork on the walls.
                  Dates will be announced in class and here.
                </li>
                <li>
                  <strong>Holiday Giving Tree</strong>
                  <br />
                  Choose an ornament with a wish list item to help a Riverbend family. Bring gifts back by November 15.
                </li>
                <li>
                  <strong>Garden Clean-Up Day</strong>
                  <br />
                  Help plant bulbs and pull weeds with your family on Saturday, November 9. Gloves provided!
                </li>
              </ul>
            </article>

            <article class="student-card card-hover">
              <div class="student-card-title">
                <span class="student-emoji">✅</span>
                Before you go
              </div>
              <ul class="student-checklist">
                <li>Ask a grown-up who is picking you up after the event and where to meet them.</li>
                <li>Pack a labeled water bottle and jacket in case the gym or playground feels chilly.</li>
                <li>Charge your Chromebook if you need it for STEM Night stations or homework afterward.</li>
              </ul>
              <p style="margin-top:0.6rem; font-size:0.82rem; color:#4b5563;">
                Need help? Use the <a class="portal-inline-link" href="https://riverbendpta.example.org/students/help" target="_blank" rel="noopener">student help form</a>
                and a counselor or PTA volunteer will follow up.
              </p>
            </article>
          </section>

          <section class="student-tips card-hover">
            <strong>How to be ready for events ⭐</strong>
            <ul class="student-tips-list">
              <li>Ask your grown-up which events you might go to this week.</li>
              <li>Check what you should wear (comfy clothes, school spirit shirt, etc.).</li>
              <li>If you’re nervous, bring a friend or ask a teacher where to go.</li>
              <li>Say “thank you” to the helpers — most of them are parents volunteering their time.</li>
              <li>Pack a small snack or water bottle if the event happens right after school.</li>
              <li>Look at the weather so you know if you need a jacket or umbrella.</li>
            </ul>
          </section>

          <div class="student-link-grid fade-seq">
            <article class="student-link-card card-hover">
              <strong>Morning announcements replay</strong>
              <p>Catch up if you missed the news crew. New episodes post by 4:00 PM each day.</p>
              <a href="https://riverbendpta.example.org/students/announcements" target="_blank" rel="noopener">Listen online</a>
            </article>

            <article class="student-link-card card-hover">
              <strong>Clubs &amp; activities schedule</strong>
              <p>See which clubs meet on which days plus pick-up locations for families.</p>
              <a href="https://riverbendpta.example.org/students/clubs" target="_blank" rel="noopener">View schedule</a>
            </article>

            <article class="student-link-card card-hover">
              <strong>Spirit wear shop</strong>
              <p>Order school shirts and hoodies so you’re ready for Spirit Fridays.</p>
              <a href="https://riverbendpta.example.org/shop" target="_blank" rel="noopener">Visit the shop</a>
            </article>
          </div>

          <p class="student-footer-note">
            If you’re not sure about any event, just ask your teacher or grown-up and they can
            check the family page for more details. 💬
          </p>
        </div>
      </section>
    </main>
  </div>
</div>

  <div class="family-action-drawer" id="family-action-drawer" hidden>
    <div class="family-action-backdrop" id="family-action-backdrop"></div>
    <div class="family-action-panel" role="dialog" aria-modal="true" aria-labelledby="family-action-title">
      <header class="family-action-header">
        <div>
          <div class="family-action-kicker">Stay in the loop</div>
          <h2 class="family-action-title" id="family-action-title">PTA updates</h2>
        </div>
        <button type="button" class="family-action-close" id="family-action-close" aria-label="Close">
          ×
        </button>
      </header>
      <div class="family-action-body" id="family-action-body"></div>
    </div>
  </div>

  <div class="principal-access-modal" id="principal-access-modal" hidden>
    <div class="principal-access-backdrop" id="principal-access-backdrop"></div>
    <div class="principal-access-dialog" role="dialog" aria-modal="true" aria-labelledby="principal-access-title">
      <header class="principal-access-header">
        <div>
          <div class="principal-access-kicker">Principal only</div>
          <h2 class="principal-access-title" id="principal-access-title">Unlock the dashboard</h2>
        </div>
        <button type="button" class="principal-access-close" id="principal-access-close" aria-label="Close">
          ×
        </button>
      </header>
      <div class="principal-access-body">
        <form id="principal-login-form" class="principal-access-form">
          <label class="principal-access-label" for="principal-password-input">Access password</label>
          <input type="password" id="principal-password-input" class="principal-access-input" autocomplete="current-password"
            required placeholder="Enter password" />
          <button type="submit" class="principal-access-submit">Unlock dashboard</button>
          <button type="button" class="principal-access-secondary" id="principal-open-reset">
            Forgot or reset password
          </button>
          <p class="principal-access-hint">Unlocking keeps this tab active for four hours on this device.</p>
        </form>
        <div class="principal-access-status" id="principal-access-status" role="alert" aria-live="assertive"></div>

        <section id="principal-reset-section" class="principal-reset-section" hidden aria-labelledby="principal-reset-heading">
          <header class="principal-reset-header">
            <div>
              <div class="principal-reset-kicker">Secure reset</div>
              <h3 id="principal-reset-heading">Generate a new access password</h3>
              <p>Create a recovery kit, verify the code, then set a brand-new password.</p>
            </div>
            <button type="button" class="principal-access-secondary" id="principal-reset-back">
              Back to sign-in
            </button>
          </header>
          <ol class="principal-reset-steps" id="principal-reset-steps">
            <li class="active" data-step="kit">1. Recovery kit</li>
            <li data-step="verify">2. Verify code</li>
            <li data-step="set">3. New password</li>
          </ol>
          <div class="principal-reset-flow">
            <div class="principal-reset-step" data-step="kit" id="principal-reset-kit-step">
              <p>
                Generate a one-time recovery kit that you can screenshot or copy. Share it with your assistant principal so the
                dashboard is never locked out.
              </p>
              <button type="button" class="principal-access-submit" id="principal-reset-generate">
                Create recovery kit
              </button>
              <div class="principal-reset-kit" id="principal-reset-kit" hidden>
                <div class="principal-reset-code" id="principal-reset-code" aria-live="polite"></div>
                <div class="principal-reset-meta">
                  <span id="principal-reset-countdown">Expires in 15:00</span>
                  <button type="button" class="principal-access-secondary" id="principal-reset-copy">Copy code</button>
                </div>
                <p class="principal-reset-tip">We also saved this code locally so you can finish the reset without leaving the
                  page.</p>
              </div>
            </div>
            <form class="principal-reset-step" data-step="verify" id="principal-reset-verify-step" hidden>
              <label class="principal-access-label" for="principal-reset-code-input">Enter the 6-digit recovery code</label>
              <input type="text" inputmode="numeric" pattern="\d{6}" maxlength="6" minlength="6"
                class="principal-access-input" id="principal-reset-code-input" placeholder="Example: 204819" required />
              <button type="submit" class="principal-access-submit">Verify code</button>
            </form>
            <form class="principal-reset-step" data-step="set" id="principal-reset-set-step" hidden>
              <label class="principal-access-label" for="principal-reset-password">New password</label>
              <input type="password" id="principal-reset-password" class="principal-access-input" autocomplete="new-password"
                required placeholder="Create new password" />
              <label class="principal-access-label" for="principal-reset-confirm">Confirm new password</label>
              <input type="password" id="principal-reset-confirm" class="principal-access-input" autocomplete="new-password"
                required placeholder="Re-enter password" />
              <p class="principal-access-hint">Use at least 8 characters with a mix of letters, numbers, and a symbol.</p>
              <button type="submit" class="principal-access-submit">Save new password</button>
            </form>
            <div class="principal-reset-success" id="principal-reset-success" hidden>
              <div class="principal-reset-celebrate" aria-hidden="true">🎉</div>
              <h4>Password updated!</h4>
              <p>Your new password is active immediately. We’ve cleared the old recovery kit for security.</p>
              <div class="principal-reset-newpass" id="principal-reset-newpass" hidden>
                <span>New password:</span>
                <code id="principal-reset-newpass-text"></code>
                <button type="button" class="principal-access-secondary" id="principal-reset-newpass-copy">Copy</button>
              </div>
              <button type="button" class="principal-access-submit" id="principal-reset-finish">Return to sign-in</button>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>

  <script>
    // --- Principal access + global view toggle ---
    const bodyElement = document.body;
    const viewButtons = document.querySelectorAll(".view-toggle-btn");
    const views = document.querySelectorAll(".view");
    let activeViewId =
      (Array.from(views).find(view => view.classList.contains("active")) || views[0])?.id || null;

    const principalView = document.getElementById("principal-view");
    const principalLockedBanner = document.getElementById("principal-locked-banner");
    const principalManageAccessBtn = document.getElementById("principal-manage-access");

    const principalAccessModal = document.getElementById("principal-access-modal");
    const principalAccessBackdrop = document.getElementById("principal-access-backdrop");
    const principalAccessClose = document.getElementById("principal-access-close");
    const principalLoginForm = document.getElementById("principal-login-form");
    const principalPasswordInput = document.getElementById("principal-password-input");
    const principalAccessStatus = document.getElementById("principal-access-status");
    const principalOpenResetBtn = document.getElementById("principal-open-reset");
    const principalResetSection = document.getElementById("principal-reset-section");
    const principalResetBackBtn = document.getElementById("principal-reset-back");
    const principalResetSteps = document.getElementById("principal-reset-steps");
    const principalResetKitStep = document.getElementById("principal-reset-kit-step");
    const principalResetGenerateBtn = document.getElementById("principal-reset-generate");
    const principalResetKit = document.getElementById("principal-reset-kit");
    const principalResetCodeElem = document.getElementById("principal-reset-code");
    const principalResetCountdown = document.getElementById("principal-reset-countdown");
    const principalResetCopyBtn = document.getElementById("principal-reset-copy");
    const principalResetVerifyStep = document.getElementById("principal-reset-verify-step");
    const principalResetCodeInput = document.getElementById("principal-reset-code-input");
    const principalResetSetStep = document.getElementById("principal-reset-set-step");
    const principalResetPasswordInput = document.getElementById("principal-reset-password");
    const principalResetConfirmInput = document.getElementById("principal-reset-confirm");
    const principalResetSuccess = document.getElementById("principal-reset-success");
    const principalResetFinishBtn = document.getElementById("principal-reset-finish");
    const principalResetNewPass = document.getElementById("principal-reset-newpass");
    const principalResetNewPassText = document.getElementById("principal-reset-newpass-text");
    const principalResetNewPassCopy = document.getElementById("principal-reset-newpass-copy");

    const BODY_THEME_CLASSES = ["theme-family", "theme-principal", "theme-board", "theme-student"];
    const VIEW_THEMES = {
      "family-view": "theme-family",
      "principal-view": "theme-principal",
      "pta-board-view": "theme-board",
      "student-view": "theme-student"
    };

    const PRINCIPAL_PASSWORD_KEY = "ptaPrincipalPasswordHash";
    const PRINCIPAL_RESET_KEY = "ptaPrincipalResetKit";
    const PRINCIPAL_UNLOCK_KEY = "ptaPrincipalUnlockedUntil";
    const PRINCIPAL_UNLOCK_DURATION = 4 * 60 * 60 * 1000;
    const RESET_EXPIRATION_MS = 15 * 60 * 1000;
    const DEFAULT_PRINCIPAL_PASSWORD = "RiverbendLead!2024";

    let principalAccessGranted = false;
    let pendingViewButton = null;
    let principalCountdownTimer;
    let lastSetPrincipalPassword = "";
    const resetStepOrder = { kit: 0, verify: 1, set: 2 };

    function safeGet(storage, key) {
      try {
        return storage.getItem(key);
      } catch (error) {
        console.warn("Storage get failed", error);
        return null;
      }
    }

    function safeSet(storage, key, value) {
      try {
        storage.setItem(key, value);
      } catch (error) {
        console.warn("Storage set failed", error);
      }
    }

    function safeRemove(storage, key) {
      try {
        storage.removeItem(key);
      } catch (error) {
        console.warn("Storage remove failed", error);
      }
    }

    function hashPassword(value) {
      try {
        return btoa(value);
      } catch (error) {
        return btoa(unescape(encodeURIComponent(value)));
      }
    }

    function ensureDefaultPrincipalPassword() {
      const stored = safeGet(localStorage, PRINCIPAL_PASSWORD_KEY);
      if (!stored) {
        safeSet(localStorage, PRINCIPAL_PASSWORD_KEY, hashPassword(DEFAULT_PRINCIPAL_PASSWORD));
      }
    }

    function getStoredPrincipalPasswordHash() {
      return safeGet(localStorage, PRINCIPAL_PASSWORD_KEY);
    }

    function setPrincipalPassword(newPassword) {
      safeSet(localStorage, PRINCIPAL_PASSWORD_KEY, hashPassword(newPassword));
    }

    function storeResetKit(code, expiresAt) {
      safeSet(localStorage, PRINCIPAL_RESET_KEY, JSON.stringify({ code, expiresAt }));
    }

    function loadResetKit() {
      const raw = safeGet(localStorage, PRINCIPAL_RESET_KEY);
      if (!raw) return null;
      try {
        return JSON.parse(raw);
      } catch (error) {
        return null;
      }
    }

    function clearResetKit() {
      safeRemove(localStorage, PRINCIPAL_RESET_KEY);
    }

    function markPrincipalUnlocked() {
      safeSet(sessionStorage, PRINCIPAL_UNLOCK_KEY, String(Date.now() + PRINCIPAL_UNLOCK_DURATION));
    }

    function isPrincipalUnlocked() {
      const raw = safeGet(sessionStorage, PRINCIPAL_UNLOCK_KEY);
      if (!raw) return false;
      const expires = Number(raw);
      return Number.isFinite(expires) && expires > Date.now();
    }

    function applyViewTheme(targetId) {
      const themeClass = VIEW_THEMES[targetId] || VIEW_THEMES["family-view"];
      BODY_THEME_CLASSES.forEach(theme => bodyElement.classList.remove(theme));
      bodyElement.classList.add(themeClass);
    }

    function switchView(targetId) {
      if (!targetId || activeViewId === targetId) return;
      viewButtons.forEach(button => {
        const matches = button.getAttribute("data-view-target") === targetId;
        button.classList.toggle("active", matches);
        button.setAttribute("aria-pressed", String(matches));
      });
      views.forEach(view => {
        const isTarget = view.id === targetId;
        view.classList.toggle("active", isTarget);
        if (!isTarget) {
          view.setAttribute("aria-hidden", "true");
          view.setAttribute("hidden", "");
        } else {
          view.setAttribute("aria-hidden", "false");
          view.removeAttribute("hidden");
        }
      });
      activeViewId = targetId;
      applyViewTheme(targetId);
    }

    function updatePrincipalLockState() {
      if (!principalView) return;
      if (principalAccessGranted) {
        principalView.removeAttribute("data-locked");
        if (principalLockedBanner) {
          principalLockedBanner.hidden = true;
        }
      } else {
        principalView.setAttribute("data-locked", "true");
        if (principalLockedBanner) {
          principalLockedBanner.hidden = false;
        }
      }
    }

    function setPrincipalAccessStatus(message, type = "info") {
      if (!principalAccessStatus) return;
      if (!message) {
        principalAccessStatus.textContent = "";
        principalAccessStatus.classList.remove("is-visible", "is-error", "is-success");
        principalAccessStatus.hidden = true;
        return;
      }
      principalAccessStatus.textContent = message;
      principalAccessStatus.hidden = false;
      principalAccessStatus.classList.add("is-visible");
      principalAccessStatus.classList.toggle("is-error", type === "error");
      principalAccessStatus.classList.toggle("is-success", type === "success");
      if (type !== "error" && type !== "success") {
        principalAccessStatus.classList.remove("is-error", "is-success");
      }
    }

    function resetPrincipalAccessStatus() {
      setPrincipalAccessStatus("");
    }

    function stopResetCountdown() {
      if (principalCountdownTimer) {
        clearInterval(principalCountdownTimer);
        principalCountdownTimer = undefined;
      }
    }

    function startResetCountdown(expiresAt) {
      if (!principalResetCountdown) return;
      stopResetCountdown();
      function tick() {
        const remaining = expiresAt - Date.now();
        if (remaining <= 0) {
          principalResetCountdown.textContent = "Expired";
          stopResetCountdown();
          if (principalResetKit) principalResetKit.hidden = true;
          clearResetKit();
          goToResetStep("kit");
          setPrincipalAccessStatus("The recovery code expired. Generate a new kit to continue.", "error");
          return;
        }
        const totalSeconds = Math.floor(remaining / 1000);
        const minutes = String(Math.floor(totalSeconds / 60)).padStart(2, "0");
        const seconds = String(totalSeconds % 60).padStart(2, "0");
        principalResetCountdown.textContent = `Expires in ${minutes}:${seconds}`;
      }
      tick();
      principalCountdownTimer = setInterval(tick, 1000);
    }

    function goToResetStep(step) {
      const order = resetStepOrder[step] ?? 0;
      if (principalResetSteps) {
        principalResetSteps.querySelectorAll("li").forEach(item => {
          const itemStep = item.getAttribute("data-step") || "kit";
          const itemOrder = resetStepOrder[itemStep] ?? 0;
          item.classList.toggle("active", itemOrder === order);
          item.classList.toggle("complete", itemOrder < order);
        });
      }
      if (principalResetVerifyStep) principalResetVerifyStep.hidden = order < resetStepOrder.verify;
      if (principalResetSetStep) principalResetSetStep.hidden = order < resetStepOrder.set;
      if (principalResetSuccess) principalResetSuccess.hidden = true;
      if (principalResetKitStep) {
        principalResetKitStep.classList.toggle("is-complete", order > resetStepOrder.kit);
      }
    }

    function openPrincipalAccessModal() {
      if (!principalAccessModal) return;
      principalAccessModal.hidden = false;
      requestAnimationFrame(() => principalAccessModal.classList.add("active"));
      document.body.classList.add("prevent-scroll");
      resetPrincipalAccessStatus();
      setPrincipalAccessStatus("Enter your access password to unlock the dashboard.", "info");
      if (principalResetSection) principalResetSection.hidden = true;
      if (principalLoginForm) principalLoginForm.hidden = false;
      if (principalResetSuccess) principalResetSuccess.hidden = true;
      if (principalResetNewPass) principalResetNewPass.hidden = true;
      stopResetCountdown();
      if (principalPasswordInput) {
        principalPasswordInput.value = "";
        setTimeout(() => principalPasswordInput.focus(), 80);
      }
    }

    function closePrincipalAccessModal() {
      if (!principalAccessModal) return;
      principalAccessModal.classList.remove("active");
      if (!(familyActionDrawer && !familyActionDrawer.hidden)) {
        document.body.classList.remove("prevent-scroll");
      }
      setTimeout(() => {
        principalAccessModal.hidden = true;
      }, 200);
      pendingViewButton = null;
      stopResetCountdown();
      if (principalResetSection) principalResetSection.hidden = true;
      if (principalLoginForm) principalLoginForm.hidden = false;
      if (principalResetSuccess) principalResetSuccess.hidden = true;
      if (principalResetNewPass) principalResetNewPass.hidden = true;
      resetPrincipalAccessStatus();
    }

    function openResetFlow() {
      if (!principalResetSection || !principalLoginForm) return;
      principalLoginForm.hidden = true;
      principalResetSection.hidden = false;
      if (principalResetSuccess) principalResetSuccess.hidden = true;
      if (principalResetNewPass) principalResetNewPass.hidden = true;
      if (principalResetCodeInput) principalResetCodeInput.value = "";
      if (principalResetPasswordInput) principalResetPasswordInput.value = "";
      if (principalResetConfirmInput) principalResetConfirmInput.value = "";
      const kit = loadResetKit();
      stopResetCountdown();
      if (kit && kit.expiresAt > Date.now()) {
        if (principalResetKit) principalResetKit.hidden = false;
        if (principalResetCodeElem) principalResetCodeElem.textContent = kit.code;
        goToResetStep("verify");
        startResetCountdown(kit.expiresAt);
        setPrincipalAccessStatus("Recovery kit restored. Enter the code below to continue.", "info");
      } else {
        clearResetKit();
        if (principalResetKit) principalResetKit.hidden = true;
        goToResetStep("kit");
        setPrincipalAccessStatus("Step 1: create a recovery kit to begin the reset.", "info");
      }
      setTimeout(() => {
        if (principalResetCodeInput && principalResetVerifyStep && !principalResetVerifyStep.hidden) {
          principalResetCodeInput.focus();
        }
      }, 120);
    }

    function returnToLoginFromReset() {
      stopResetCountdown();
      if (principalResetSection) principalResetSection.hidden = true;
      if (principalLoginForm) principalLoginForm.hidden = false;
      if (principalResetKit) principalResetKit.hidden = true;
      if (principalResetSuccess) principalResetSuccess.hidden = true;
      if (principalResetNewPass) principalResetNewPass.hidden = true;
      if (principalPasswordInput) {
        setTimeout(() => principalPasswordInput.focus(), 80);
      }
      setPrincipalAccessStatus("Enter your access password to unlock the dashboard.", "info");
    }

    function generateResetKit() {
      const code = String(Math.floor(100000 + Math.random() * 900000));
      const expiresAt = Date.now() + RESET_EXPIRATION_MS;
      if (principalResetCodeElem) principalResetCodeElem.textContent = code;
      if (principalResetKit) principalResetKit.hidden = false;
      storeResetKit(code, expiresAt);
      goToResetStep("verify");
      setPrincipalAccessStatus("Recovery kit generated. Enter the code to verify your identity.", "success");
      startResetCountdown(expiresAt);
      if (principalResetCodeInput) {
        principalResetCodeInput.value = "";
        setTimeout(() => principalResetCodeInput.focus(), 80);
      }
    }

    function validatePrincipalPassword(value) {
      const hasLength = value.length >= 8;
      const hasLetter = /[A-Za-z]/.test(value);
      const hasNumber = /\d/.test(value);
      const hasSymbol = /[^A-Za-z0-9\s]/.test(value);
      return hasLength && hasLetter && hasNumber && hasSymbol;
    }

    function copyToClipboard(text) {
      if (navigator.clipboard && navigator.clipboard.writeText) {
        return navigator.clipboard.writeText(text);
      }
      const textarea = document.createElement("textarea");
      textarea.value = text;
      textarea.setAttribute("readonly", "");
      textarea.style.position = "absolute";
      textarea.style.left = "-9999px";
      document.body.appendChild(textarea);
      textarea.select();
      try {
        const succeeded = document.execCommand("copy");
        document.body.removeChild(textarea);
        return succeeded ? Promise.resolve() : Promise.reject(new Error("Copy failed"));
      } catch (error) {
        document.body.removeChild(textarea);
        return Promise.reject(error);
      }
    }

    function showResetSuccess(newPassword) {
      if (principalResetSteps) {
        principalResetSteps.querySelectorAll("li").forEach(item => {
          item.classList.add("complete");
          item.classList.remove("active");
        });
        const finalStep = principalResetSteps.querySelector('li[data-step="set"]');
        if (finalStep) finalStep.classList.add("active");
      }
      if (principalResetVerifyStep) principalResetVerifyStep.hidden = true;
      if (principalResetSetStep) principalResetSetStep.hidden = true;
      if (principalResetKitStep) principalResetKitStep.classList.add("is-complete");
      if (principalResetSuccess) principalResetSuccess.hidden = false;
      if (principalResetNewPass && principalResetNewPassText) {
        principalResetNewPassText.textContent = newPassword;
        principalResetNewPass.hidden = false;
      }
      stopResetCountdown();
    }

    function handlePrincipalLogin(event) {
      event.preventDefault();
      const entered = principalPasswordInput ? principalPasswordInput.value.trim() : "";
      if (!entered) {
        setPrincipalAccessStatus("Enter the access password to continue.", "error");
        if (principalPasswordInput) principalPasswordInput.focus();
        return;
      }
      const storedHash = getStoredPrincipalPasswordHash();
      if (storedHash && hashPassword(entered) === storedHash) {
        principalAccessGranted = true;
        markPrincipalUnlocked();
        updatePrincipalLockState();
        closePrincipalAccessModal();
        switchView("principal-view");
        if (typeof setPrincipalStatus === "function") {
          setPrincipalStatus("Principal dashboard unlocked. Session active for four hours.");
        }
        lastSetPrincipalPassword = entered;
        if (principalPasswordInput) principalPasswordInput.value = "";
      } else {
        setPrincipalAccessStatus("Incorrect password. Try again or reset it below.", "error");
        if (principalPasswordInput) {
          principalPasswordInput.select();
          principalPasswordInput.focus();
        }
      }
    }

    ensureDefaultPrincipalPassword();
    principalAccessGranted = isPrincipalUnlocked();
    updatePrincipalLockState();
    applyViewTheme(activeViewId);

    viewButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const targetId = btn.getAttribute("data-view-target");
        if (targetId === "principal-view" && !principalAccessGranted) {
          pendingViewButton = btn;
          openPrincipalAccessModal();
          return;
        }
        switchView(targetId);
      });
    });

    if (principalManageAccessBtn) {
      principalManageAccessBtn.addEventListener("click", () => {
        pendingViewButton = principalManageAccessBtn;
        openPrincipalAccessModal();
      });
    }

    if (principalAccessClose) {
      principalAccessClose.addEventListener("click", () => closePrincipalAccessModal());
    }

    if (principalAccessBackdrop) {
      principalAccessBackdrop.addEventListener("click", () => closePrincipalAccessModal());
    }

    document.addEventListener("keydown", evt => {
      if (evt.key === "Escape") {
        if (principalAccessModal && !principalAccessModal.hidden) {
          closePrincipalAccessModal();
          return;
        }
        if (familyActionDrawer && !familyActionDrawer.hidden) {
          closeFamilyAction();
        }
      }
    });

    if (principalLoginForm) {
      principalLoginForm.addEventListener("submit", handlePrincipalLogin);
    }

    if (principalOpenResetBtn) {
      principalOpenResetBtn.addEventListener("click", () => openResetFlow());
    }

    if (principalResetBackBtn) {
      principalResetBackBtn.addEventListener("click", () => returnToLoginFromReset());
    }

    if (principalResetGenerateBtn) {
      principalResetGenerateBtn.addEventListener("click", () => generateResetKit());
    }

    if (principalResetCopyBtn) {
      principalResetCopyBtn.addEventListener("click", () => {
        const code = principalResetCodeElem ? principalResetCodeElem.textContent.trim() : "";
        if (!code) {
          setPrincipalAccessStatus("Generate a recovery kit before copying.", "error");
          return;
        }
        copyToClipboard(code)
          .then(() => setPrincipalAccessStatus("Recovery code copied to your clipboard.", "success"))
          .catch(() => setPrincipalAccessStatus("Copy failed. Use Ctrl+C or tap-and-hold to copy the code.", "error"));
      });
    }

    if (principalResetVerifyStep) {
      principalResetVerifyStep.addEventListener("submit", event => {
        event.preventDefault();
        const inputCode = principalResetCodeInput ? principalResetCodeInput.value.trim() : "";
        const kit = loadResetKit();
        if (!kit) {
          setPrincipalAccessStatus("Generate a recovery kit first.", "error");
          goToResetStep("kit");
          if (principalResetKit) principalResetKit.hidden = true;
          return;
        }
        if (kit.expiresAt <= Date.now()) {
          setPrincipalAccessStatus("That recovery code has expired. Generate a new kit.", "error");
          clearResetKit();
          if (principalResetKit) principalResetKit.hidden = true;
          goToResetStep("kit");
          stopResetCountdown();
          return;
        }
        if (kit.code !== inputCode) {
          setPrincipalAccessStatus("That code doesn’t match the recovery kit.", "error");
          if (principalResetCodeInput) principalResetCodeInput.focus();
          return;
        }
        setPrincipalAccessStatus("Code verified. Set a new password below.", "success");
        goToResetStep("set");
        if (principalResetPasswordInput) {
          setTimeout(() => principalResetPasswordInput.focus(), 80);
        }
      });
    }

    if (principalResetSetStep) {
      principalResetSetStep.addEventListener("submit", event => {
        event.preventDefault();
        const newPassword = principalResetPasswordInput ? principalResetPasswordInput.value.trim() : "";
        const confirmPassword = principalResetConfirmInput ? principalResetConfirmInput.value.trim() : "";
        if (!validatePrincipalPassword(newPassword)) {
          setPrincipalAccessStatus(
            "Use at least 8 characters with a letter, number, and symbol for the new password.",
            "error"
          );
          if (principalResetPasswordInput) principalResetPasswordInput.focus();
          return;
        }
        if (newPassword !== confirmPassword) {
          setPrincipalAccessStatus("Passwords do not match. Try again.", "error");
          if (principalResetConfirmInput) principalResetConfirmInput.focus();
          return;
        }
        setPrincipalPassword(newPassword);
        clearResetKit();
        lastSetPrincipalPassword = newPassword;
        showResetSuccess(newPassword);
        setPrincipalAccessStatus(
          "Password updated. Return to sign-in to unlock the dashboard with your new password.",
          "success"
        );
      });
    }

    if (principalResetFinishBtn) {
      principalResetFinishBtn.addEventListener("click", () => {
        returnToLoginFromReset();
        if (principalPasswordInput) {
          principalPasswordInput.value = lastSetPrincipalPassword;
          principalPasswordInput.focus();
        }
        if (lastSetPrincipalPassword) {
          setPrincipalAccessStatus(
            "Password updated. Enter it above to unlock the dashboard.",
            "success"
          );
        }
      });
    }

    if (principalResetNewPassCopy) {
      principalResetNewPassCopy.addEventListener("click", () => {
        const text = principalResetNewPassText ? principalResetNewPassText.textContent : "";
        copyToClipboard(text || "")
          .then(() => setPrincipalAccessStatus("New password copied to clipboard.", "success"))
          .catch(() => setPrincipalAccessStatus("Copy failed. Select the password and copy manually.", "error"));
      });
    }
    // --- Family view date + year ---
    const familyTodayElem = document.getElementById("family-today-date");
    const familyYearElem = document.getElementById("family-year");
    const now = new Date();
    const dateOptions = { weekday: "long", month: "long", day: "numeric" };
    if (familyTodayElem) familyTodayElem.textContent = now.toLocaleDateString(undefined, dateOptions);
    if (familyYearElem) familyYearElem.textContent = now.getFullYear();

    // --- Family actions & downloads ---
    const familyRequestEmailBtn = document.getElementById("family-request-email-btn");
    const familyTextAlertBtn = document.getElementById("family-text-alert-btn");
    const familyCalendarBtn = document.getElementById("family-calendar-btn");
    const familyInfoFeedback = document.getElementById("family-info-feedback");
    const familyActionDrawer = document.getElementById("family-action-drawer");
    const familyActionBody = document.getElementById("family-action-body");
    const familyActionClose = document.getElementById("family-action-close");
    const familyActionTitle = document.getElementById("family-action-title");
    const familyActionBackdrop = document.getElementById("family-action-backdrop");

    const FAMILY_EMAIL_ADDRESS = "subscribe@riverbendpta.example.org";
    const TEXT_ALERT_NUMBER = "+15550123";
    const TEXT_ALERT_DISPLAY = "(555) 012-3PTA";
    const TEXT_ALERT_KEYWORD = "JOIN RIVERBEND";

    const calendarEvents = [
      {
        title: "Book Fair — Family Night",
        start: "2024-10-15T17:00",
        end: "2024-10-15T19:30",
        description: "Shop the fair together with literacy stations and a snack table supported by PTA volunteers.",
        location: "Riverbend Elementary Library",
        display: "Tue, Oct 15 · 5:00 – 7:30 PM"
      },
      {
        title: "Walk & Roll to School Day",
        start: "2024-10-16T07:10",
        end: "2024-10-16T07:45",
        description: "Meet at the corners around campus for the walking school bus and crosswalk cheers.",
        location: "Neighborhood routes to Riverbend Elementary",
        display: "Wed, Oct 16 · 7:10 – 7:45 AM"
      },
      {
        title: "PTA Meeting & Budget Q&A",
        start: "2024-10-22T19:00",
        end: "2024-10-22T20:00",
        description: "Hybrid meeting with finance updates, committee spotlights, and open Q&A for families.",
        location: "Riverbend Elementary Media Center + Zoom",
        display: "Tue, Oct 22 · 7:00 – 8:00 PM"
      },
      {
        title: "STEM Night",
        start: "2024-11-07T18:00",
        end: "2024-11-07T20:00",
        description: "Hands-on stations, robotics demos, and student presenters across the building.",
        location: "Riverbend Elementary Campus",
        display: "Thu, Nov 7 · 6:00 – 8:00 PM"
      },
      {
        title: "Community Garden Clean-Up",
        start: "2024-11-09T09:00",
        end: "2024-11-09T11:30",
        description: "Mulch delivery, planter refresh, and family-friendly outdoor projects.",
        location: "Riverbend Community Garden",
        display: "Sat, Nov 9 · 9:00 – 11:30 AM"
      },
      {
        title: "Teacher Conference Meals",
        start: "2024-11-18T08:30",
        end: "2024-11-20T17:00",
        description: "PTA coordinates daily meals for teachers during fall conferences; drop-off help welcome.",
        location: "Riverbend Elementary Staff Lounge",
        display: "Nov 18 – Nov 20"
      }
    ];

    let familyFeedbackTimer;
    let familyActionOrigin = null;

    function setFamilyFeedback(message) {
      if (!familyInfoFeedback) return;
      familyInfoFeedback.textContent = message;
      familyInfoFeedback.hidden = false;
      familyInfoFeedback.classList.add("is-visible");
      clearTimeout(familyFeedbackTimer);
      familyFeedbackTimer = setTimeout(() => {
        familyInfoFeedback.classList.remove("is-visible");
        familyInfoFeedback.hidden = true;
      }, 7000);
    }

    function closeFamilyAction() {
      if (!familyActionDrawer) return;
      familyActionDrawer.classList.remove("active");
      setTimeout(() => {
        familyActionDrawer.hidden = true;
        if (familyActionBody) familyActionBody.innerHTML = "";
      }, 220);
      if (!(principalAccessModal && !principalAccessModal.hidden)) {
        document.body.classList.remove("prevent-scroll");
      }
      if (familyActionOrigin) {
        familyActionOrigin.focus();
        familyActionOrigin = null;
      }
    }

    function focusFamilyAction() {
      if (!familyActionBody) return;
      const first = familyActionBody.querySelector(
        'input, button, textarea, select, a[href]'
      );
      if (first) first.focus();
    }

    function openFamilyAction(type, origin) {
      if (!familyActionDrawer || !familyActionBody || !familyActionTitle) return;
      familyActionOrigin = origin || null;
      familyActionBody.innerHTML = "";
      familyActionDrawer.hidden = false;
      requestAnimationFrame(() => familyActionDrawer.classList.add("active"));
      document.body.classList.add("prevent-scroll");
      if (type === "email") {
        familyActionTitle.textContent = "Request weekly e-mails";
        renderEmailAction();
      } else if (type === "text") {
        familyActionTitle.textContent = "Join PTA text alerts";
        renderTextAction();
      } else {
        familyActionTitle.textContent = "Download the PTA calendar";
        renderCalendarAction();
      }
      setTimeout(() => focusFamilyAction(), 120);
    }

    function renderEmailAction() {
      if (!familyActionBody) return;
      familyActionBody.innerHTML = `
        <p>We will pre-fill an e-mail to ${FAMILY_EMAIL_ADDRESS}. Add any notes and send it to join the weekly update list.</p>
        <form class="family-action-form" id="family-email-form">
          <label class="family-action-label" for="family-email-name">Your name</label>
          <input class="family-action-input" id="family-email-name" name="family-email-name" type="text" required placeholder="Example: Jordan Lee" />
          <label class="family-action-label" for="family-email-address">Preferred e-mail address</label>
          <input class="family-action-input" id="family-email-address" name="family-email-address" type="email" required placeholder="you@example.com" />
          <label class="family-action-label" for="family-email-notes">Notes (optional)</label>
          <textarea class="family-action-textarea" id="family-email-notes" rows="3" placeholder="Add grandparents, grade-level notes, or questions."></textarea>
          <button type="submit" class="family-action-primary">Compose request e-mail</button>
          <p class="family-action-note">Your default mail app will open with a ready-to-send message.</p>
        </form>
        <button type="button" class="family-action-secondary" id="family-email-copy">Copy pre-written message</button>
      `;

      function composeEmailTemplate() {
        const nameInput = document.getElementById("family-email-name");
        const emailInput = document.getElementById("family-email-address");
        const notesInput = document.getElementById("family-email-notes");
        const name = nameInput ? nameInput.value.trim() : "Riverbend family";
        const address = emailInput ? emailInput.value.trim() : "";
        const notes = notesInput ? notesInput.value.trim() : "";
        const lines = [
          "Hello Riverbend PTA team,",
          "",
          `Please add ${name || "our family"} to the weekly PTA update list.`,
          address ? `Preferred e-mail: ${address}` : "Preferred e-mail: (same as this message)"
        ];
        if (notes) {
          lines.push("", notes);
        }
        lines.push("", "Thank you!");
        return { name, address, notes, lines };
      }

      const emailForm = document.getElementById("family-email-form");
      if (emailForm) {
        emailForm.addEventListener("submit", event => {
          event.preventDefault();
          const template = composeEmailTemplate();
          const subject = encodeURIComponent("Add me to PTA updates");
          const body = encodeURIComponent(template.lines.join("\n"));
          const mailto = `mailto:${FAMILY_EMAIL_ADDRESS}?subject=${subject}&body=${body}`;
          window.location.href = mailto;
          const addressSuffix = template.address ? ` for ${template.address}` : "";
          setFamilyFeedback(`Email draft opened. Finish sending it to join the weekly PTA updates${addressSuffix}.`);
          closeFamilyAction();
        });
      }

      const copyBtn = document.getElementById("family-email-copy");
      if (copyBtn) {
        copyBtn.addEventListener("click", () => {
          const template = composeEmailTemplate();
          const message = `${template.lines.join("\n")}\n\nSend to: ${FAMILY_EMAIL_ADDRESS}`;
          copyToClipboard(message)
            .then(() => setFamilyFeedback("Copied the PTA subscription message. Paste it into any e-mail app."))
            .catch(() => setFamilyFeedback(`Copy failed. Email ${FAMILY_EMAIL_ADDRESS} with subject “Add me to PTA updates.”`));
        });
      }
    }

    function renderTextAction() {
      if (!familyActionBody) return;
      familyActionBody.innerHTML = `
        <p>We’ll prepare the exact opt-in message so you can start receiving PTA text alerts.</p>
        <form class="family-action-form" id="family-text-form">
          <label class="family-action-label" for="family-text-number">Your mobile number</label>
          <input class="family-action-input" id="family-text-number" name="family-text-number" type="tel" required placeholder="555-123-4567" />
          <button type="submit" class="family-action-primary">Open messaging app</button>
          <p class="family-action-note">Standard messaging rates may apply. Reply STOP anytime to unsubscribe.</p>
        </form>
        <div class="family-action-steps">
          <h3>What happens next</h3>
          <ol class="family-action-list">
            <li>We’ll launch your SMS app addressed to ${TEXT_ALERT_DISPLAY}.</li>
            <li>Tap send to deliver “${TEXT_ALERT_KEYWORD}”.</li>
            <li>Look for a confirmation reply within a minute.</li>
          </ol>
        </div>
        <button type="button" class="family-action-secondary" id="family-text-copy">Copy join message</button>
      `;

      const textForm = document.getElementById("family-text-form");
      if (textForm) {
        textForm.addEventListener("submit", event => {
          event.preventDefault();
          const smsLink = `sms:${TEXT_ALERT_NUMBER}?&body=${encodeURIComponent(TEXT_ALERT_KEYWORD)}`;
          window.location.href = smsLink;
          setFamilyFeedback(`Opening your messaging app. Send “${TEXT_ALERT_KEYWORD}” to ${TEXT_ALERT_DISPLAY}.`);
          closeFamilyAction();
        });
      }

      const copyBtn = document.getElementById("family-text-copy");
      if (copyBtn) {
        copyBtn.addEventListener("click", () => {
          const content = `${TEXT_ALERT_KEYWORD}\nText to: ${TEXT_ALERT_DISPLAY}`;
          copyToClipboard(content)
            .then(() => setFamilyFeedback(`Copied the opt-in message. Text “${TEXT_ALERT_KEYWORD}” to ${TEXT_ALERT_DISPLAY}.`))
            .catch(() => setFamilyFeedback(`Copy failed. Manually text “${TEXT_ALERT_KEYWORD}” to ${TEXT_ALERT_DISPLAY}.`));
        });
      }
    }

    function formatUtc(date) {
      return date.toISOString().replace(/[-:]/g, "").split(".")[0] + "Z";
    }

    function toIcsDateTime(value) {
      const [datePart, timePart = "00:00"] = value.split("T");
      const date = datePart.replace(/-/g, "");
      const time = (timePart.length === 5 ? `${timePart}:00` : timePart).replace(/:/g, "");
      return `${date}T${time}`;
    }

    function escapeIcsText(text) {
      let safe = String(text);
      safe = safe.split("\\").join("\\\\");
      safe = safe.split(";").join("\\;");
      safe = safe.split(",").join("\\,");
      safe = safe.split("\r").join("");
      safe = safe.split("\n").join("\\n");
      return safe;
    }

    function buildIcsContent(events) {
      const lines = [
        "BEGIN:VCALENDAR",
        "VERSION:2.0",
        "PRODID:-//Riverbend Elementary PTA//Calendar//EN",
        "CALSCALE:GREGORIAN",
        "METHOD:PUBLISH"
      ];
      const stamp = formatUtc(new Date());
      events.forEach(event => {
        const uid = (window.crypto && crypto.randomUUID)
          ? crypto.randomUUID()
          : `${Date.now()}-${Math.random().toString(16).slice(2)}`;
        lines.push("BEGIN:VEVENT");
        lines.push(`UID:${uid}@riverbendpta.local`);
        lines.push(`DTSTAMP:${stamp}`);
        lines.push(`DTSTART;TZID=America/Chicago:${toIcsDateTime(event.start)}`);
        lines.push(`DTEND;TZID=America/Chicago:${toIcsDateTime(event.end)}`);
        lines.push(`SUMMARY:${escapeIcsText(event.title)}`);
        if (event.description) lines.push(`DESCRIPTION:${escapeIcsText(event.description)}`);
        if (event.location) lines.push(`LOCATION:${escapeIcsText(event.location)}`);
        lines.push("END:VEVENT");
      });
      lines.push("END:VCALENDAR");
      return lines.join("\r\n");
    }

    function downloadIcsFile(filename, content) {
      const blob = new Blob([content], { type: "text/calendar;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    function renderCalendarAction() {
      if (!familyActionBody) return;
      const eventsMarkup = calendarEvents
        .map(event => `
          <li class="family-action-event">
            <strong>${event.title}</strong>
            <span>${event.display}</span>
            <p>${event.description}</p>
          </li>
        `)
        .join("");
      familyActionBody.innerHTML = `
        <p>Download an .ics file that includes the latest PTA events so you can subscribe in any calendar app.</p>
        <ul class="family-action-events">${eventsMarkup}</ul>
        <button type="button" class="family-action-primary" id="family-calendar-download">Download .ics file</button>
        <p class="family-action-note">Import into Google Calendar, Apple Calendar, Outlook, or any app that supports .ics files.</p>
      `;
      const downloadBtn = document.getElementById("family-calendar-download");
      if (downloadBtn) {
        downloadBtn.addEventListener("click", () => {
          const icsContent = buildIcsContent(calendarEvents);
          downloadIcsFile("riverbend-pta-calendar.ics", icsContent);
          setFamilyFeedback("Downloaded the PTA calendar (.ics) with this month’s events.");
          closeFamilyAction();
        });
      }
    }

    if (familyRequestEmailBtn) {
      familyRequestEmailBtn.addEventListener("click", () => openFamilyAction("email", familyRequestEmailBtn));
    }

    if (familyTextAlertBtn) {
      familyTextAlertBtn.addEventListener("click", () => openFamilyAction("text", familyTextAlertBtn));
    }

    if (familyCalendarBtn) {
      familyCalendarBtn.addEventListener("click", () => openFamilyAction("calendar", familyCalendarBtn));
    }

    if (familyActionClose) {
      familyActionClose.addEventListener("click", () => closeFamilyAction());
    }

    if (familyActionBackdrop) {
      familyActionBackdrop.addEventListener("click", () => closeFamilyAction());
    }

    // --- Principal header + panels ---
    const principalKicker = document.getElementById("principal-view-kicker");
    const principalTitle = document.getElementById("principal-view-title");
    const principalSub = document.getElementById("principal-view-sub");
    const principalDatePill = document.getElementById("principal-date-pill");
    const principalStatusMessage = document.getElementById("principal-status-message");
    const principalPanels = document.querySelectorAll(".principal-panel");
    const principalPanelButtons = document.querySelectorAll("[data-panel-target]");
    const principalQuickButtons = document.querySelectorAll("[data-panel-force]");
    const principalEventsRows = Array.from(document.querySelectorAll("#principal-event-table tbody tr"));
    const principalEventsCount = document.getElementById("principal-events-count");
    const principalFilterBtn = document.getElementById("principal-filter-btn");
    const principalFilterOverlay = document.getElementById("principal-filter-overlay");
    const principalFilterForm = document.getElementById("principal-filter-form");
    const principalFilterClose = document.getElementById("principal-filter-close");
    const principalFilterReset = document.getElementById("principal-filter-reset");
    const principalExportBtn = document.getElementById("principal-export-btn");
    const principalDateFormatter = new Intl.DateTimeFormat(undefined, { month: "short", day: "numeric" });
    const monday = new Date(now);
    const day = now.getDay();
    const diffToMonday = (day === 0 ? -6 : 1) - day;
    monday.setDate(now.getDate() + diffToMonday);
    const thisWeekLabel = "Week of " + principalDateFormatter.format(monday);
    const rangeStart = new Date(now);
    const rangeEnd = new Date(now);
    rangeEnd.setDate(now.getDate() + 30);
    const thirtyDayLabel =
      principalDateFormatter.format(rangeStart) + " – " + principalDateFormatter.format(rangeEnd);
    const principalPanelCopy = {
      "this-week": {
        kicker: "This Week · Snapshot",
        title: "PTA events and building impact",
        sub:
          "Current week overview. Green means comfortably covered, orange needs a second look, red means something may need to move or get extra support.",
        label: "this week"
      },
      "next-30": {
        kicker: "Next 30 days · Planning view",
        title: "Upcoming PTA schedule and approvals",
        sub:
          "Preview volunteer needs, building usage, and approvals coming due so you can plan ahead.",
        label: "the next 30 days"
      },
      "by-grade": {
        kicker: "By grade level · Coverage",
        title: "Grade-level partnerships at a glance",
        sub:
          "See which grades have events, requests, and cross-grade opportunities so you can balance support.",
        label: "grade-level coverage"
      }
    };
    const principalDateLabels = {
      "this-week": thisWeekLabel,
      "next-30": thirtyDayLabel,
      "by-grade": "Grades K–5 overview"
    };
    const defaultFocus = ["family", "staff", "students", "community"];
    const defaultTiming = ["morning", "schoolday", "evening"];
    const filterState = {
      focus: new Set(defaultFocus),
      timing: new Set(defaultTiming)
    };
    let principalStatusTimer;
    let activePanelId = "this-week";

    function setPrincipalStatus(message) {
      if (!principalStatusMessage) return;
      clearTimeout(principalStatusTimer);
      if (message) {
        principalStatusMessage.textContent = message;
        principalStatusMessage.classList.add("is-visible");
        principalStatusTimer = setTimeout(() => {
          principalStatusMessage.classList.remove("is-visible");
        }, 6000);
      } else {
        principalStatusMessage.textContent = "";
        principalStatusMessage.classList.remove("is-visible");
      }
    }

    function setsMatch(set, values) {
      if (set.size !== values.length) return false;
      return values.every(value => set.has(value));
    }

    function updateFilterButtonState() {
      if (!principalFilterBtn) return;
      const atDefault =
        setsMatch(filterState.focus, defaultFocus) && setsMatch(filterState.timing, defaultTiming);
      principalFilterBtn.classList.toggle("filters-active", !atDefault);
    }

    function syncFilterForm() {
      if (!principalFilterForm) return;
      const checkboxes = principalFilterForm.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach(box => {
        if (box.name === "focus") {
          box.checked = filterState.focus.has(box.value);
        } else if (box.name === "timing") {
          box.checked = filterState.timing.has(box.value);
        }
      });
    }

    function applyPrincipalFilters() {
      if (!principalEventsRows.length) return 0;
      let visible = 0;
      principalEventsRows.forEach(row => {
        const focusTags = row.dataset.focus ? row.dataset.focus.split(",").map(tag => tag.trim()) : [];
        const timingTag = row.dataset.timing;
        const focusMatch = focusTags.some(tag => filterState.focus.has(tag));
        const timingMatch = filterState.timing.has(timingTag);
        const show = focusMatch && timingMatch;
        row.classList.toggle("is-hidden", !show);
        if (show) visible += 1;
      });
      if (principalEventsCount) {
        principalEventsCount.textContent = `Showing ${visible} of ${principalEventsRows.length} events`;
      }
      return visible;
    }

    function activatePrincipalPanel(panelId) {
      if (!panelId) return;
      activePanelId = panelId;
      principalPanels.forEach(panel => {
        panel.classList.toggle("active", panel.dataset.panel === panelId);
      });
      principalPanelButtons.forEach(btn => {
        const isActive = btn.getAttribute("data-panel-target") === panelId;
        btn.classList.toggle("active", isActive);
        btn.setAttribute("aria-pressed", String(isActive));
      });
      const copy = principalPanelCopy[panelId];
      if (copy) {
        if (principalKicker) principalKicker.textContent = copy.kicker;
        if (principalTitle) principalTitle.textContent = copy.title;
        if (principalSub) principalSub.textContent = copy.sub;
      }
      const labelText = principalDateLabels[panelId];
      if (principalDatePill && labelText) {
        principalDatePill.textContent = labelText;
      }
      if (panelId === "this-week") {
        const visible = applyPrincipalFilters();
        setPrincipalStatus(`Showing ${visible} of ${principalEventsRows.length} events this week.`);
      } else {
        setPrincipalStatus("");
      }
    }

    principalPanelButtons.forEach(btn => {
      btn.addEventListener("click", () => activatePrincipalPanel(btn.getAttribute("data-panel-target")));
    });

    function openFilterOverlay() {
      if (!principalFilterOverlay) return;
      principalFilterOverlay.hidden = false;
      principalFilterOverlay.classList.add("active");
      document.body.classList.add("prevent-scroll");
      if (principalFilterBtn) principalFilterBtn.setAttribute("aria-expanded", "true");
      syncFilterForm();
      const firstInput = principalFilterOverlay.querySelector("input");
      if (firstInput) firstInput.focus();
    }

    function closeFilterOverlay() {
      if (!principalFilterOverlay) return;
      principalFilterOverlay.classList.remove("active");
      principalFilterOverlay.hidden = true;
      document.body.classList.remove("prevent-scroll");
      if (principalFilterBtn) {
        principalFilterBtn.setAttribute("aria-expanded", "false");
        principalFilterBtn.focus();
      }
    }

    function setPrincipalFilters({ focus, timing, announce }) {
      if (focus && focus.length) {
        filterState.focus = new Set(focus);
      }
      if (timing && timing.length) {
        filterState.timing = new Set(timing);
      }
      const visible = applyPrincipalFilters();
      updateFilterButtonState();
      syncFilterForm();
      if (announce) {
        setPrincipalStatus(announce);
      } else {
        setPrincipalStatus(`Showing ${visible} of ${principalEventsRows.length} events this week.`);
      }
    }

    if (principalFilterBtn) {
      principalFilterBtn.addEventListener("click", () => openFilterOverlay());
    }

    if (principalFilterClose) {
      principalFilterClose.addEventListener("click", () => closeFilterOverlay());
    }

    if (principalFilterOverlay) {
      principalFilterOverlay.addEventListener("click", evt => {
        if (evt.target === principalFilterOverlay) {
          closeFilterOverlay();
        }
      });
    }

    document.addEventListener("keydown", evt => {
      if (evt.key === "Escape" && principalFilterOverlay && !principalFilterOverlay.hidden) {
        closeFilterOverlay();
      }
    });

    if (principalFilterForm) {
      principalFilterForm.addEventListener("submit", evt => {
        evt.preventDefault();
        const selectedFocus = Array.from(
          principalFilterForm.querySelectorAll('input[name="focus"]:checked')
        ).map(box => box.value);
        const selectedTiming = Array.from(
          principalFilterForm.querySelectorAll('input[name="timing"]:checked')
        ).map(box => box.value);
        filterState.focus = new Set(selectedFocus.length ? selectedFocus : defaultFocus);
        filterState.timing = new Set(selectedTiming.length ? selectedTiming : defaultTiming);
        const visible = applyPrincipalFilters();
        updateFilterButtonState();
        closeFilterOverlay();
        setPrincipalStatus(`Showing ${visible} of ${principalEventsRows.length} events this week.`);
      });
    }

    if (principalFilterReset) {
      principalFilterReset.addEventListener("click", () => {
        filterState.focus = new Set(defaultFocus);
        filterState.timing = new Set(defaultTiming);
        const visible = applyPrincipalFilters();
        updateFilterButtonState();
        syncFilterForm();
        setPrincipalStatus(`Showing ${visible} of ${principalEventsRows.length} events this week.`);
      });
    }

    function highlightCard(selector) {
      const element = document.querySelector(selector);
      if (!element) return;
      element.classList.add("principal-highlight");
      setTimeout(() => element.classList.remove("principal-highlight"), 1600);
    }

    principalQuickButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const forcedPanel = btn.getAttribute("data-panel-force");
        if (forcedPanel) {
          activatePrincipalPanel(forcedPanel);
        }
        const timing = btn.getAttribute("data-filter-timing");
        const message = btn.getAttribute("data-quick-message");
        if (timing) {
          setPrincipalFilters({
            focus: defaultFocus,
            timing: [timing],
            announce: message || `Filtered to ${timing} events this week.`
          });
        } else if (message) {
          setPrincipalStatus(message);
        }
        const highlightTarget = btn.getAttribute("data-highlight-target");
        if (highlightTarget) {
          highlightCard(highlightTarget);
        }
        const scrollTarget = btn.getAttribute("data-scroll-target");
        if (scrollTarget) {
          const target = document.querySelector(scrollTarget);
          if (target) target.scrollIntoView({ behavior: "smooth", block: "center" });
        }
        btn.classList.add("active");
        setTimeout(() => btn.classList.remove("active"), 1200);
      });
    });

    const principalExportData = {
      "this-week": [
        {
          name: "Book Fair — Family Night",
          when: "Tue · 5:00 – 7:30 PM",
          focus: "Family · Fundraiser",
          notes: "Coverage comfortable; cash box pickup at 4:30 PM."
        },
        {
          name: "Walk & Roll to School Day",
          when: "Wed · 7:10 – 7:45 AM",
          focus: "Student-facing",
          notes: "Needs two additional crosswalk adults."
        },
        {
          name: "Teacher Snack Cart",
          when: "Thu · 8:30 – 11:30 AM",
          focus: "Staff support",
          notes: "Check storage for extra donations arriving Wednesday."
        },
        {
          name: "Chess Club Tournament Practice",
          when: "Thu · 3:00 – 4:15 PM",
          focus: "Student enrichment",
          notes: "Confirm dismissal coverage at the car-rider loop."
        },
        {
          name: "PTA Meeting & Budget Q&A",
          when: "Tue · 7:00 – 8:00 PM",
          focus: "Family · Governance",
          notes: "Monitor Zoom chat during the finance report."
        }
      ],
      "next-30": [
        {
          name: "STEM Night",
          when: "Nov 7 · 6:00 – 8:00 PM",
          focus: "Family · STEM",
          notes: "Finalize custodial overtime request by Oct 28."
        },
        {
          name: "Community Garden Clean-Up",
          when: "Nov 9 · 9:00 – 11:30 AM",
          focus: "Community",
          notes: "Mulch delivery scheduled for Nov 8."
        },
        {
          name: "Holiday Giving Tree Kickoff",
          when: "Nov 4 – Nov 15",
          focus: "Community care",
          notes: "Counselors coordinating support for 12 families."
        },
        {
          name: "Teacher Conference Meals",
          when: "Nov 18 – Nov 20",
          focus: "Staff support",
          notes: "Catering deposit due Nov 8."
        },
        {
          name: "Winter Concert Support",
          when: "Dec 3 · 5:30 – 8:30 PM",
          focus: "Students & families",
          notes: "Assign ushers and sound volunteer by Nov 20."
        }
      ],
      "by-grade": [
        {
          name: "Kindergarten",
          when: "Playground refresh helpers · Oct 18",
          focus: "Volunteer Chair",
          notes: "Need two more adults for paint touch-ups."
        },
        {
          name: "1st grade",
          when: "Reading Buddies kickoff · Oct 24",
          focus: "Teacher Liaison",
          notes: "Record a welcome video for families."
        },
        {
          name: "2nd grade",
          when: "Science lab docents · Oct 30",
          focus: "STEM Night Lead",
          notes: "Confirm parent training slides and lab access."
        },
        {
          name: "3rd grade",
          when: "STEM Night presenters · Nov 7",
          focus: "VP Programs",
          notes: "Recruit three additional presenters."
        },
        {
          name: "4th grade",
          when: "Walk & Roll route leaders · Nov 6",
          focus: "Safety Chair",
          notes: "Staffing on track; send thank-you note afterward."
        },
        {
          name: "5th grade",
          when: "Safety patrol breakfast · Nov 15",
          focus: "Treasurer",
          notes: "Awaiting principal approval for early cafeteria access."
        }
      ]
    };

    function exportPrincipalSnapshot() {
      const activePanel = activePanelId;
      const rows = principalExportData[activePanel] || [];
      if (!rows.length) {
        setPrincipalStatus("No data to export for this view.");
        return;
      }
      const header = ["Name", "When", "Focus", "Notes"];
      const csvLines = [header.join(",")];
      rows.forEach(item => {
        const cells = [item.name, item.when, item.focus, item.notes].map(value =>
          `"${String(value).replace(/"/g, '""')}"`
        );
        csvLines.push(cells.join(","));
      });
      const csvContent = csvLines.join("\\n");
      const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      const todayStamp = new Date().toISOString().slice(0, 10);
      link.href = url;
      link.setAttribute("download", `riverbend-principal-${activePanel}-${todayStamp}.csv`);
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      const panelLabel = principalPanelCopy[activePanel]?.label || activePanel;
      setPrincipalStatus(`Downloaded snapshot for ${panelLabel} (${rows.length} rows).`);
    }

    if (principalExportBtn) {
      principalExportBtn.addEventListener("click", exportPrincipalSnapshot);
    }

    activatePrincipalPanel(activePanelId);
    updateFilterButtonState();
    const initialVisible = applyPrincipalFilters();
    setPrincipalStatus(`Showing ${initialVisible} of ${principalEventsRows.length} events this week.`);

    // --- Family event filters ---
    const familyFilterButtons = document.querySelectorAll(".family-filter-pill");
    const familyEventCards = document.querySelectorAll("#family-this-week [data-categories]");
    familyFilterButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        const filter = btn.getAttribute("data-filter");
        familyFilterButtons.forEach(b => {
          b.classList.remove("active");
          b.setAttribute("aria-pressed", "false");
        });
        btn.classList.add("active");
        btn.setAttribute("aria-pressed", "true");

        familyEventCards.forEach(card => {
          const categories = card.dataset.categories.split(",").map(c => c.trim());
          const show = filter === "all" || categories.includes(filter);
          card.classList.toggle("filtered-out", !show);
        });
      });
    });
  </script>
</body>
</html>
